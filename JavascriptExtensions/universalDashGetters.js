// @ts-check

/**
 _    _         _                                _   _____  _             _             _      _____               _      _                             _ 
| |  | |       (_)                              | | / ____|(_)           | |           | |    |  __ \             | |    | |                           | |
| |  | | _ __   _ __   __ ___  _ __  ___   __ _ | || (___   _  _ __ ___  | |__   _   _ | |__  | |  | |  __ _  ___ | |__  | |__    ___    __ _  _ __  __| |
| |  | || '_ \ | |\ \ / // _ \| '__|/ __| / _` || | \___ \ | || '_ ` _ \ | '_ \ | | | || '_ \ | |  | | / _` |/ __|| '_ \ | '_ \  / _ \  / _` || '__|/ _` |
| |__| || | | || | \ V /|  __/| |   \__ \| (_| || | ____) || || | | | | || | | || |_| || |_) || |__| || (_| |\__ \| | | || |_) || (_) || (_| || |  | (_| |
 \____/ |_| |_||_|  \_/  \___||_|   |___/ \__,_||_||_____/ |_||_| |_| |_||_| |_| \__,_||_.__/ |_____/  \__,_||___/|_| |_||_.__/  \___/  \__,_||_|   \__,_|
                                                                                                                                                           
MMMMMMMMMMMMMMMMMMMMMMMMMMWNXKKKXNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWN0Okkkk0XWMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNOxx0NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWx. .lKWNXXXXXNNNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMKc''.,cc:;;;:oo:;;codkOKXNWMMMMMMMMMMMMMMMMMMMMMMMMXkkkkO0O000OOXWMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNKOxxO0KKKKXNMMMMMMMMMM0c;'........;ol,....  ..',:loxO0XNWWMMMMMMMMMMMMWWWK:....'.','.;0MMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWWMMMMMMMMMMMMMMMMMMMMMMMW0o:;;:oxkkxoc:clodkOOOOkko,''..'.....,::,.'''''.........',;cloxkOKNWMMMMNx:cc'......''...:ooxK
MMMMMMMMMMMMMMMMMMMMMMMMMMWXklccldkKXKNWMMMMMMMMMMMMWNOc.'lollo0WMMWNXKOd,..,;,'...''.',,'..'''''',,,,;;,,,''''..........';dXMMMWd.      ........'..,O
MMMMMMMMMMMMMMMMMMMMMMMXkl,';;;;''cxO0000000000000000Odc,.;dO0KKKKOddxxdc;:llodddxxxxkxxxxxxxkkkOxOkkOkOOOOdokkxkxxdoooollloox000k;.....  ..        .k
MMMMMMMMMMMMMMMMMMMMMNkc;:cccccclc:,,;:lodxddkkxxkkOOddxk00KKK0KNM0lokxolloodxxxdddoodddddxxxkkxxoxdxkk00KXdlddooodoolloolo0NNk:,''cooolc'...       ,0
MMMMMMWXKX00KKK00XXXOl;;ol,.    .'lo:,:xXXNK0Okx0XNN0l:oOK0000kONNxxOo;,,''''ckKKK000OOOOOOOOOkxdoooodolcdOOOkkkkkOkkook00kxdl;,coc;'..';coc,.      cN
MMMMWXO0XKolOXXOdkK0o,;dl. .;::;.  cd:,:oddl;...;dddo:;cc',dO0XWWOxKl,lxkxdo:.:XMMMMMMMMMMMMNOdl::lxOOo,:dxxxxxxxkkkko'...   .,oo.  .,,.  'dl;.   .cKW
MMMWKOXWO:,',xNKooxd;.':.  cd'.:,  .:,..              .....',;:clcdO:;dkOkxdo',OMMMMMMMMMMMMN0Oo:loOXXl,ldloxOxoc;''..      ..,c'  .::::.  'c,..  'OMM
MMWK0XWNOc;,'l0kokKOl,;o:  .cc::.  ,o;,cdkkkx:       .'.....'''''.'::,:xOOxo;;OWMMMMMMMMMMMMMMXl',ccd0doxdol:,..            ..,:.  .:;;:.  .:'.,;cxNMM
xod0XXKKK0O0XKX0okKKk:.;xl.  ..  .:d:.:0WMMMMk.        .  .........',.....,,,o0000000000000000Oo::c;,;'..                    .'lo.  .;;.  .ol';kWMMMMM
kdxKXXKO0KO0XK0OOXMMWK:..clc:;::clc'.;OWMMMMWd.      ..            .''..      ..        .........             ....             .:oc,....,co:..dNMMMMMM
MMWNNNNNWWWWMMMMMMMMMMNkc;;;::::,.,lkNMMMMMMWOc;;;;;;::;;;;;;;;;;;::;;;;,,''''......................'''''''',;::;,''''''',::;;;,.'lolcclc;'':OWMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMWX0kxdddxOXWMMMMMMMMMMWWWWWWWWWWWWWWWWWWWWWWWWWWWWNNNNNNNXXXXXXKKKKKKKKKKKXXXXXXXXXXXXXXNNNNNNNNNWWMWWWNKxoc:,,;:lxKWMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNXXNWMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
 */

/**
 * ==== TABLE OF CONTENTS ====
 * When a "game name" is referred to, it means the [CurrentGame] property in SimHub.
 * When a "label map" is referred to, it means an object with one of the following shapes:
 * {
 *   [key]: string | { label: string, color: string }
 * }
 * It can include only a string label, or a label and color for text display.
 * Colors are formatted as ARGB hex, as such: `#AARRGGBB`
 *
 * Every section consists of constants in the following order:
 * - Game and/or car class specific labels for the outline of the full section on the dashboard, if any such are necessary. These control the visibility of the whole section.
 *   To make the segment invisible, just set it to an empty string. Setting a nullish value will cause a fallback to the generic value
 * - Misc. game specific maps, which map the value coming from the game to arbitrary useful values
 * - Global misc. maps, which maps game and/or car class names to their respective game specific misc. maps
 * - Game and/or car class specific label maps, which map the value coming from the game to human-readable text
 * - Global label maps, which maps game names to their respective game specific label maps
 * - Global game property maps, which maps game names to the specific game property that supplies that value for that game
 * - Global transformation maps, which maps game properties to whatever transformation should be performed on them to normalize the value.
 *   These are actually higher order functions, which take in the current game, current class, and current car ID as parameters and then decide which transformation to apply based on that.
 * - Global UI property maps, which maps game and/or car class names to the UI labels for dashboard elements. These control the visibility of the subsection.
 *   To make the segment invisible, just set it to an empty string. Setting a nullish value will cause a fallback to the generic value
 * - Global popup property maps, which maps game and/or car class names to the UI labels for the popup elements when the property is modified. These control the enabled state of the popup
 *   To make the popup invisible, just set it to an empty string. Setting a nullish value will cause a fallback to the generic value
 *
 * 0. UTILS
 * - 0.a INTERNAL HELPERS
 * - 0.b SIMHUB HELPERS (you might want to call these from SimHub. They include things like calculating a delta from the previous lap)
 * --------
 * 1. ERS
 *	- 1.a ERS MODE
 *	- 1.b ERS SOC
 *	- 1.c ERS CURRENT
 *	- 1.d ERS RECOVERY
 *  - 1.e ERS DELTA
 *  - 1.e ERS LAP
 *   ------------
 *  2. CAR CONTROL
 *	- 2.a TRACTION CONTROL
 *  - 2.b TC SLIP
 *  - 2.c TC CUT
 *  - 2.d ABS
 *  - 2.e BRAKE BIAS
 *  - 2.f BRAKE MIGRATION
 *  ---------------------
 *  3. FUEL
 *  - 3.a FUEL STATE
 *  - 3.b FUEL USAGE
 *  - 3.c FUEL TIME
 *  - 3.d FUEL LAPS
 *  - 3.e FUEL DELTA
 *  - 3.f NRG STATE
 *  - 3.g NRG USAGE
 * -----------------
 *  4. TEMPS
 *  - 4.a OIL TEMP
 *  - 4.b WATER TEMP
 *  - 4.c ENGINE TEMP
 */

/**
 * -----------------
 *  5. TYRES
 *  - 5.a FL TEMP
 *  - 5.b FL WEAR
 *  - 5.c FL PRES
 *  - 5.d FR TEMP
 *  - 5.e FR WEAR
 *  - 5.f FR PRES
 *  - 5.g RL TEMP
 *  - 5.h RL WEAR
 *  - 5.i RL PRES
 *  - 5.j RR TEMP
 *  - 5.k RR WEAR
 *  - 5.l RR PRES
 *  - 5.m WEAR TRANSFORMATION (Wear might be reported inverted depending on game. Some games report maximum wear as 100%, some as 0%)
 *  - 5.n IDEAL RANGES
 *  - 5.o FL TYRE
 *  - 5.p FR TYRE
 *  - 5.q RL TYRE
 *  - 5.r RR TYRE
 * -------------
 *  6. BRAKES
 *  - 6.a FL TEMP
 *  - 6.b FR TEMP
 *  - 6.c RL TEMP
 *  - 6.d RR TEMP
 *  - 6.e IDEAL RANGES
 * --------------
 *  TODO: ------ Everything below this is not yet implemented ------
 *  7. DAMAGE
 *  - 7.a FRONT BODY
 *  - 7.b FL BODY
 *  - 7.c FR BODY
 *  - 7.d MID RIGHT BODY
 *  - 7.e MID LEFT BODY
 *  - 7.f REAR BODY
 *  - 7.g RL BODY
 *  - 7.h RL BODY
 *  - 7.i FL WING
 *  - 7.j FR WING
 *  - 7.k REAR WING
 * ----------------
 *  8. SUSPENSION
 *  - 8.a FRONT ARB
 *  - 8.b REAR ARB
 * -----------------
 *  9. MISCELLANEOUS
 *  - 9.a PIT LIMITER
 * ------------------
 *  10. OUTPUTS
 *  - 10.a getTelemetryLabelsAndValues (master output function, this is the underlying function called by every other function on SimHub's side, which exposes everything in this file)
 *    !!! YOU **MUST** ADD NEW VALUES TO THE OUTPUT OF `getTelemetryLabelsAndValues` IF YOU ADD NEW MAPPING SECTIONS !!!
 *  - 10.b HELPERS (functions that have more specific uses, to simplify calling form SimHub. For example: "getMasterSectionLabel" will just return the label of the master section instead of a bunch of unneeded details)
 * ===========================
 */

/**
 * ==== 0. UTILS SECTION ====
 * Reusable logic, classes, helpers, etc
 * It's very likely you don't have to change anything in this section
 * ========================
 */

/**
 * @typedef {string | number} GamePropertyKey
 */

/**
 * @typedef {{[key: GamePropertyKey]: string}} StringRecord
 */

/**
 * @typedef {{[key: GamePropertyKey]: string | null}} NullableStringRecord
 */

/**
 * @typedef {{[key: GamePropertyKey]: {[key: GamePropertyKey]: FunctionRecord} | (function(...any): any) | GameOrCarClassNullableFunctionRecord}} GameOrCarClassNullableFunctionRecord
 */

/**
 * @typedef {{[key: GamePropertyKey]: NullableStringRecord | string | null}} GameOrCarClassNullableStringRecord
 */

/**
 * @typedef {{[key: GamePropertyKey]: null | { optimal: number, goodThreshold: number, criticalThreshold: number } | GameOrCarClassOptimalRangeRecord}} GameOrCarClassOptimalRangeRecord
 */

/**
 * @typedef {{[key: GamePropertyKey]: function(...any): string | number}} FunctionRecord
 */

/**
 * @typedef {{[key: GamePropertyKey]: function(...any): function(...any): string | number}} HigherOrderFunctionRecord
 */

/**
 * @typedef {{ label: string; color: string | null; } | string} LabelColor
 */

/**
 * @typedef {{[key: GamePropertyKey]: { label: string; color: string | null; } | string}} LabelColorRecord
 */

/**
 * @typedef {{[key: GamePropertyKey]: LabelMap | {[key: GamePropertyKey]: LabelMap}}} GameOrCarClassLabelMapRecord
 */

/**
 * @typedef {{[key: GamePropertyKey]: null | LabelMap | {[key: GamePropertyKey]: LabelMap }}} NullableGameOrCarClassLabelMapRecord
 */

/**
 * @param {LabelColor} map
 */
function getOrCreateLabelAndColor(map) {
  if (typeof map === "string") {
    // TODO: Consider replacing `null` with `#FFFFFFFF` in case `null` breaks dashboard styling
    return { label: map, color: null };
  }

  return map;
}

class LabelMap {
  /** @type {LabelColorRecord} */
  _map;

  /**
   * @param {LabelColorRecord} map
   */
  constructor(map) {
    this._map = Object.fromEntries(Object.entries(map).map(([key, value]) => [key, getOrCreateLabelAndColor(value)]));
  }

  /**
   * @param {string} key
   */
  getLabel(key) {
    return typeof this._map[key] === "string" ? this._map[key] : this._map[key].label;
  }
  /**
   * @param {string} key
   */
  getColor(key) {
    return typeof this._map[key] === "string" ? this._map[key] : this._map[key].color;
  }
}

/**
 * @param {number} value
 * @param {number} decimalPrecision
 */
function numberToFixed(value, decimalPrecision = 2) {
  return Number.parseFloat(value.toFixed(decimalPrecision));
}

/**
 * @param {number | string} currentValue
 * @param {string} currentFormattedTime
 * @param {{ [x: string]: string | number | null | undefined; }} root
 * @param {number} delayInMS
 */
function changedSinceTimeMs(currentValue, currentFormattedTime, root, delayInMS = 2000) {
  if (!root) {
    throw new Error(
      `Provided root is ${root}. Functions that rely on persistent calculation must receive a root object`
    );
  }

  if (currentFormattedTime === null || currentFormattedTime === undefined) {
    throw new Error("You must enable System Info plugin in Simhub Settings for this function to work!");
  }

  const currentTimeMs = Date.parse(currentFormattedTime);

  root.time = currentTimeMs;
  root.oldState = root.oldState === null || root.oldState === undefined ? currentValue : root.newState;
  root.newState = currentValue;

  if (root.newState !== root.oldState) {
    root.triggerTime = root.time;
  }

  return root.triggerTime === null || root.triggerTime === undefined
    ? false
    : // @ts-expect-error Time is always a number, it's ok
      root.time - root.triggerTime <= delayInMS;
}

/**
 * @param {number} currentLapNumber
 * @param {number | string} currentValue
 * @param {{ previousLapNumber: number | null | undefined, valuesToCycle: (string | number)[] | null | undefined }} root
 * @param {number} nValues
 */
function cycleValuesOverNLaps(currentLapNumber, currentValue, root, nValues = 3) {
  if (!root) {
    throw new Error(
      `Provided root is ${root}. Functions that rely on persistent calculation must receive a root object`
    );
  }

  root.previousLapNumber = root.previousLapNumber ?? currentLapNumber;

  if (root.valuesToCycle === null || root.valuesToCycle === undefined) {
    cycleValuesOverNEntries(currentValue, root, nValues);
  }

  if (root.previousLapNumber !== currentLapNumber) {
    root.previousLapNumber = currentLapNumber;
    cycleValuesOverNEntries(currentValue, root, nValues);
  }

  // biome-ignore lint/complexity/useLiteralKeys: <explanation>
  return root["valuesToCycle"];
}

/**
 * @param {number | string} currentValue
 * @param {{ valuesToCycle: (string | number)[] | null | undefined }} root
 * @param {number} nValues
 */
function cycleValuesOverNEntries(currentValue, root, nValues = 3) {
  root.valuesToCycle = root.valuesToCycle ?? Array(nValues).fill(null);
  root.valuesToCycle.shift();
  root.valuesToCycle.push(currentValue);

  return root.valuesToCycle;
}

/**
 * @param {number} currentLapNumber
 * @param {number} currentValue
 * @param {{ [x: string]: number | null | undefined; }} root
 * @param {number} decimalPrecision
 */
function deltaOverLastLap(currentLapNumber, currentValue, root, decimalPrecision = 2) {
  const inputValue = Number(currentValue);

  if (!root) {
    throw new Error(
      `Provided root is ${root}. Functions that rely on persistent calculation must receive a root object`
    );
  }

  if (root.previousLapNumber === undefined || root.previousLapNumber === null) {
    root.previousLapNumber = currentLapNumber;
  }

  if (root.previousValue === undefined || root.previousValue === null) {
    root.previousValue = inputValue;
  }

  if (root.previousDiff === undefined || root.previousDiff === null) {
    root.previousDiff = 0;
  }

  const previousLapNumber = root.previousLapNumber;
  const previousValue = root.previousValue;
  const previousDiff = root.previousDiff;

  if (previousLapNumber !== currentLapNumber) {
    const valueDiff = inputValue - previousValue;

    root.previousValue = inputValue;
    root.previousLapNumber = currentLapNumber;
    root.previousDiff = valueDiff;

    return numberToFixed(valueDiff, decimalPrecision);
  }

  return numberToFixed(previousDiff, decimalPrecision);
}

/**
 * @param {[]} value
 */
function debugArray(value) {
  return value.join(", ");
}

/**
 * @param {{}} value
 */
function debugObject(value) {
  return Object.keys(value).join(", ");
}

/**
 * @param {number} currentLapNumber
 * @param {number} lastLapTimeSeconds
 * @param {number} currentValue
 * @param {number} previousValue
 * @param {number} timeSpan
 * @param {{ resultEstimate: number | null, previousLapNumber: number | null; totalMeasurementTimeSeconds: number | null; valueAverageOverTimeSpan: number | null; }} root
 */
function estimateRequiredForSeconds(currentLapNumber, lastLapTimeSeconds, currentValue, previousValue, timeSpan, root) {
  root.resultEstimate = root.resultEstimate ?? 0;

  root.previousLapNumber = root.previousLapNumber ?? 0;
  root.totalMeasurementTimeSeconds = root.totalMeasurementTimeSeconds ?? 0;
  root.valueAverageOverTimeSpan = root.valueAverageOverTimeSpan ?? 0;

  if (root.previousLapNumber !== currentLapNumber) {
    root.totalMeasurementTimeSeconds = (root.totalMeasurementTimeSeconds + lastLapTimeSeconds) / 2;
    root.valueAverageOverTimeSpan = (root.valueAverageOverTimeSpan + previousValue) / 2;

    const calcTime = timeSpan / root.totalMeasurementTimeSeconds;

    root.resultEstimate = calcTime * root.valueAverageOverTimeSpan - currentValue + previousValue;
    root.previousLapNumber = currentLapNumber;
  }

  return Math.ceil(root.resultEstimate || 0) || "-";
}

/**
 * @param {string} currentGame
 * @param {string | undefined} currentCarClass
 * @param {GameOrCarClassNullableFunctionRecord} map
 * @param {string | undefined} currentCarId
 */
function getGameOrClassFunctionOverrides(currentGame, currentCarClass, map, currentCarId) {
  if (currentGame in map) {
    const gameMap = map[currentGame];

    if (!gameMap || typeof gameMap === "number") {
      return gameMap;
    }

    if (currentCarId && currentCarId in gameMap) {
      return gameMap[currentCarId];
    }

    if (currentCarClass && currentCarClass in gameMap) {
      return gameMap[currentCarClass];
    }

    if ("Generic" in gameMap) {
      return gameMap.Generic;
    }
  }

  if (currentCarClass && currentCarClass in map) {
    return map[currentCarClass];
  }

  if ("Generic" in map) {
    return map.Generic;
  }

  return null;
}

/**
 * @param {string} currentGame
 * @param {string | undefined} currentCarClass
 * @param {GameOrCarClassOptimalRangeRecord} map
 * @param {string | undefined} currentCarId
 * @param {string | undefined} currentTyre
 */
function getGameOrClassNumberOverrides(currentGame, currentCarClass, map, currentCarId, currentTyre) {
  if (currentGame in map) {
    const gameMap = map[currentGame];

    if (!gameMap || typeof gameMap === "number") {
      return gameMap;
    }

    if (currentCarId && currentCarId in gameMap) {
      if (currentTyre && currentTyre in gameMap[currentCarId]) {
        return gameMap[currentCarId][currentTyre];
      }

      return gameMap[currentCarId];
    }

    if (currentCarClass && currentCarClass in gameMap) {
      if (currentTyre && currentTyre in gameMap[currentCarClass]) {
        return gameMap[currentCarClass][currentTyre];
      }

      return gameMap[currentCarClass];
    }

    if ("Generic" in gameMap) {
      if (gameMap.Generic && currentTyre && currentTyre in gameMap.Generic) {
        return gameMap.Generic[currentTyre];
      }

      return gameMap.Generic;
    }
  }

  if (currentCarClass && currentCarClass in map) {
    if (map[currentCarClass] && currentTyre && currentTyre in map[currentCarClass]) {
      return map[currentCarClass][currentTyre];
    }

    return map[currentCarClass];
  }

  if (currentTyre && map && currentTyre in map) {
    return map[currentTyre];
  }

  if ("Generic" in map) {
    if (map.Generic && currentTyre && currentTyre in map.Generic) {
      return map.Generic[currentTyre];
    }

    return map.Generic;
  }

  return null;
}

/**
 * @param {string} currentGame
 * @param {string | undefined} currentCarClass
 * @param {GameOrCarClassNullableStringRecord} map
 * @param {string | undefined} currentCarId
 * @param {string | undefined} currentTyre
 */
function getGameOrClassStringOverrides(currentGame, currentCarClass, map, currentCarId, currentTyre = undefined) {
  if (currentGame in map) {
    const gameMap = map[currentGame];
    if (!gameMap || typeof gameMap === "string") {
      return gameMap;
    }

    if (currentCarId && currentCarId in gameMap) {
      if (
        currentTyre &&
        gameMap[currentCarId] &&
        typeof gameMap[currentCarId] !== "string" &&
        currentTyre in gameMap[currentCarId]
      ) {
        return gameMap[currentCarId][currentTyre];
      }

      return gameMap[currentCarId];
    }

    if (currentCarClass && currentCarClass in gameMap) {
      if (
        currentTyre &&
        gameMap[currentCarClass] &&
        typeof gameMap[currentCarClass] !== "string" &&
        currentTyre in gameMap[currentCarClass]
      ) {
        return gameMap[currentCarClass][currentTyre];
      }

      return gameMap[currentCarClass];
    }

    if (currentTyre && gameMap[currentTyre]) {
      return gameMap[currentTyre];
    }

    if ("Generic" in gameMap) {
      if (currentTyre && gameMap.Generic && typeof gameMap.Generic !== "string" && currentTyre in gameMap.Generic) {
        return gameMap.Generic[currentTyre];
      }

      return gameMap.Generic;
    }
  }

  if (currentCarClass && currentCarClass in map) {
    if (
      currentTyre &&
      map[currentCarClass] &&
      typeof map[currentCarClass] !== "string" &&
      currentTyre in map[currentCarClass]
    ) {
      return map[currentCarClass][currentTyre];
    }

    return map[currentCarClass];
  }

  if ("Generic" in map) {
    if (currentTyre && map.Generic && typeof map.Generic !== "string" && currentTyre in map.Generic) {
      return map.Generic[currentTyre];
    }

    return map.Generic;
  }
  if (currentTyre && currentTyre in map) {
    return map[currentTyre];
  }

  return null;
}
/**
 * @param {string} currentGame
 * @param {string | undefined} currentCarClass
 * @param {NullableGameOrCarClassLabelMapRecord} map
 * @param {string | undefined} currentCarId
 *
 * @returns {LabelMap | null}
 */
function getGameOrClassLabelMapOverrides(currentGame, currentCarClass, map, currentCarId) {
  if (currentGame in map && map[currentGame]) {
    const gameMap = map[currentGame];

    if (currentCarId && currentCarId in gameMap && gameMap[currentCarId]) {
      return gameMap[currentCarId];
    }

    if (currentCarClass && currentCarClass in gameMap && gameMap[currentCarClass]) {
      return gameMap[currentCarClass];
    }

    // @ts-expect-error
    return gameMap;
  }

  if (currentCarClass && currentCarClass in map && map[currentCarClass]) {
    // @ts-expect-error
    return map[currentCarClass];
  }

  if ("Generic" in map && map.Generic) {
    // @ts-expect-error
    return map.Generic;
  }

  return null;
}

/**
 * ==== 1. ERS SECTION ====
 * All hardcoded maps, labels and game properties related to ERS functionality go here
 * ========================
 */
/** @type {StringRecord} */
const ERS_MASTER_SECTION_UI_LABELS = {
  Generic: "Motor",
  Hyper: "ERS",
  LMP1: "ERS",
  AssettoCorsaCompetizione: "Engine",
  GT3: "Sett",
  GTE: "Sett",
};

/**
 * ---- 1.a ERS MODE SECTION ----
 * Describes current ERS deployment mode
 */
/** @type {StringRecord} */
const AMS_ERS_MODE_LABEL_MAP = {
  1: "Off",
  2: "Build",
  3: "Balanced",
  4: "Attack",
  5: "Quali",
};
/** @type {StringRecord} */
const AC1_ERS_MODE_LABEL_MAP = {
  0: "Charging",
  1: "Low 1",
  2: "Low 2",
  3: "High 1",
  4: "High 2",
  5: "Quali",
};
/** @type {StringRecord} */
/**
 * Aston Martin V12 and V8 GT3
 * Audi R8 GT3 and GT3 EVO
 * Bentley Continental GT3 2016 and 2018
 * Lamborghini Huracan GT3 and GT3 EVO
 */
const ACC_DRY_WET_PACE_CAR_MAPS = {
  1: "1 - DRY FAST",
  2: "2 - DRY",
  3: "3 - DRY",
  4: "4 - DRY FUEL SAVE",
  5: "5 - WET",
  6: "6 - WET FUEL SAVE",
  7: "7 - WET FUEL SAVE",
  8: "8 - SAFETY CAR",
};
/**
 * Ferrari 488 GT3
 */
const ACC_FERRARI_GT3_MAPS = {
  1: "1 - DRY FAST",
  2: "2 - DRY FUEL SAVE",
  3: "3 - DRY",
  4: "4 - DRY SLOW",
  5: "5 - WET",
  6: "6 - WET FUEL SAVE",
  7: "7 - WET",
  8: "8 - WET SLOW",
  9: "9 - SAFETY CAR",
  10: "10 - SAFETY CAR",
  11: "11 - SAFETY CAR",
  12: "12 - SAFETY CAR",
};
/**
 * Ferrari 488 GT3 EVO
 */
const ACC_FERRARI_GT3_EVO_MAPS = {
  1: "1 - DRY FAST",
  2: "2 - DRY FAST",
  3: "3 - DRY",
  4: "4 - DRY FUEL SAVE",
  5: "5 - DRY FUEL SAVE",
  6: "6 - WET FUEL SAVE",
  7: "7 - WET",
  8: "8 - WET SLOW",
  9: "9 - SAFETY CAR",
  10: "10 - SAFETY CAR",
  11: "11 - SAFETY CAR",
  12: "12 - SAFETY CAR",
};
/**
 * BMW M6 and M4 GT3
 */
const ACC_BMW_MAPS = {
  1: "1 - DRY FAST",
  2: "2 - DRY",
  3: "3 - DRY",
  4: "4 - RESERVE",
  5: "5 - SAFETY CAR",
  6: "6 - WET FAST",
  7: "7 - WET",
  8: "8 - WET",
};
/**
 * HONDA NSX GT3 and GT3 EVO
 */
const ACC_HONDA_MAPS = {
  1: "1 - DRY PROG",
  2: "2 - DRY LINEAR",
  3: "3 - DRY AGGR",
  4: "4 - DRY MAX",
  5: "5 - WET PROG",
  6: "6 - WET PROG",
  7: "7 - WET FUEL SAVE",
  8: "8 - SAFETY CAR",
};
/**
 * LAMBORGHINI GALLARDO R-EX
 */
const ACC_GALLARDO_MAPS = {
  1: "1 - FAST",
  2: "2 - AGGR",
  3: "3 - PROG",
  4: "4 - FUEL SAVE",
};
/**
 * JAGUAR
 */
const ACC_JAGUAR_MAPS = {
  1: "1 - DRY FAST",
  2: "2 - DRY",
  3: "3 - DRY FUEL SAVE",
  4: "4 - WET FAST",
  5: "5 - WET",
  6: "6 - WET FUEL SAVE",
};
/**
 * NISSAN GT-R GT3 2016 and 2018
 * MERCEDES AMG GT3 and GT3 2020
 */
const ACC_SHORT_MAPS = {
  1: "1 - DRY FAST",
  2: "2 - DRY",
  3: "3 - DRY FUEL SAVE",
  4: "4 - FUEL SAVE MODE",
};
/**
 * LEXUS RC F GT3
 */
const ACC_LEXUS_MAPS = {
  1: "1 - DRY LINEAR",
  2: "2 - DRY AGGR",
  3: "3 - DRY PROG",
  4: "4 - FUEL SAVE / WET",
  5: "5 - SAFETY CAR",
};
/**
 * MCLAREN 650S GT3
 */
const ACC_650S_MAPS = {
  1: "1 - DRY FAST",
  2: "2 - DRY",
  3: "3 - DRY",
  4: "4 - DRY FUEL SAVE",
  5: "5 - WET FAST",
  6: "6 - WET FUEL SAVE",
  7: "7 - WET",
  8: "8 - WET FUEL SAVE",
  9: "9 - SAFETY CAR",
};
/**
 * MCLAREN 720S GT3
 */
const ACC_720S_MAPS = {
  1: "1 - QUALI",
  2: "2 - RACE 1",
  3: "3 - RACE 2",
  4: "4 - RACE 1 FUEL SAVE",
  5: "5 - RACE 2 FUEL SAVE",
  6: "6 - RACE 3 FUEL SAVE",
  7: "7 - ENGINE HI TEMP",
  8: "8 - DAMP QUALI",
  9: "9 - DAMP RACE FUEL SAVE",
  10: "10 - WET QUALI",
  11: "11 - WET RACE 1",
  12: "12 - WET RACE 2",
};
/**
 * PORSCHE 911 GT3-R and GT3-R EVO
 */
const ACC_PORSCHE_MAPS = {
  1: "1 - DRY",
  2: "2 - DRY PROG",
  3: "3 - DRY AGGR",
  4: "4 - WET",
  5: "5 - QUALI",
  6: "6 - QUALI PROG",
  7: "7 - QUALI AGGR",
  8: "8 - DRY QUALI",
  9: "9 - FUEL SAVE",
  10: "10 - SAFETY CAR",
};

/** @type {NullableGameOrCarClassLabelMapRecord} */
const ERS_MODE_LABEL_MAP = {
  Automobilista2: new LabelMap(AMS_ERS_MODE_LABEL_MAP),
  AssettoCorsa: new LabelMap(AC1_ERS_MODE_LABEL_MAP),
  AssettoCorsaCompetizione: {
    amr_v12_vantage_gt3: new LabelMap(ACC_DRY_WET_PACE_CAR_MAPS),
    audi_r8_lms_evo: new LabelMap(ACC_DRY_WET_PACE_CAR_MAPS),
    bentley_continental_gt3_2018: new LabelMap(ACC_DRY_WET_PACE_CAR_MAPS),
    bmw_m6_gt3: new LabelMap(ACC_BMW_MAPS),
    ferrari_488_gt3: new LabelMap(ACC_FERRARI_GT3_MAPS),
    honda_nsx_gt3_evo: new LabelMap(ACC_HONDA_MAPS),
    lamborghini_huracan_gt3_evo: new LabelMap(ACC_DRY_WET_PACE_CAR_MAPS),
    lamborghini_huracan_gt3: new LabelMap(ACC_DRY_WET_PACE_CAR_MAPS),
    mclaren_650s_gt3: new LabelMap(ACC_650S_MAPS),
    mclaren_720s_gt3: new LabelMap(ACC_720S_MAPS),
    mercedes_amg_gt3: new LabelMap(ACC_SHORT_MAPS),
    nissan_gt_r_gt3_2018: new LabelMap(ACC_SHORT_MAPS),
    porsche_911ii_gt3_r: new LabelMap(ACC_PORSCHE_MAPS),

    // Not tested: I do not own these cars for ACC. The keys might need to be renamed to match the in-game car ID
    amr_v8_vantage_gt3: new LabelMap(ACC_DRY_WET_PACE_CAR_MAPS),
    audi_r8_lms_evoii: new LabelMap(ACC_DRY_WET_PACE_CAR_MAPS),
    bentley_continental_gt3_2015: new LabelMap(ACC_DRY_WET_PACE_CAR_MAPS),
    bmw_m4_gt3: new LabelMap(ACC_BMW_MAPS),
    emil_frey_jaguar_gt3: new LabelMap(ACC_JAGUAR_MAPS),
    ferrari_488_gt3_evo: new LabelMap(ACC_FERRARI_GT3_EVO_MAPS),
    honda_nsx_gt3: new LabelMap(ACC_HONDA_MAPS),
    lexus_rc_f_gt3: new LabelMap(ACC_LEXUS_MAPS),
    mclaren_720s_gt3_evo: new LabelMap(ACC_720S_MAPS),
    mercedes_amg_gt3_evo: new LabelMap(ACC_SHORT_MAPS),
    nissan_gt_r_gt3_2015: new LabelMap(ACC_SHORT_MAPS),
    porsche_911_gt3_r: new LabelMap(ACC_PORSCHE_MAPS),
    reiter_engineering_r_ex_gt3: new LabelMap(ACC_GALLARDO_MAPS),
  },
  LMU: null,
};
/** @type {GameOrCarClassNullableStringRecord} */
const ERS_MODE_GAME_PROPERTY_MAP = {
  Generic: "EngineMap",
  Automobilista2: "GameRawData.mErsDeploymentMode",
  AssettoCorsa: "GameRawData.Physics.ErsPowerLevel",
  LMU: {
    Hyper: "LMU_NeoRedPlugin.Extended.VM_ELECTRIC_MOTOR_MAP",
    Generic: "LMU_NeoRedPlugin.Extended.VM_ENGINE_MIXTURE",
  },
};
/** @type {HigherOrderFunctionRecord} */
const ERS_MODE_TRANSFORMATION_MAP = {
  "LMU_NeoRedPlugin.Extended.VM_ENGINE_MIXTURE": () => (/** @type {string} */ word) => {
    if (word.length <= 6) {
      return word.toUpperCase();
    }

    const wordSections = word.split(/[-_ ,.]/);

    return wordSections.map((word) => word.charAt(0).toUpperCase()).join("");
  },
};
/** @type {GameOrCarClassNullableStringRecord} */
const ERS_MODE_UI_PROPERTY_MAP = {
  Generic: "Mode",
  Automobilista2: "Mode",
  AssettoCorsa: "Mode",
  LMU: { Hyper: "Map" },
  LMP1: "Deploy",
  AssettoCorsaCompetizione: "Map",
  GT3: "Map",
  GTE: "Mix",
};
/** @type {GameOrCarClassNullableStringRecord} */
const ERS_MODE_POPUP_MAP = {
  Generic: "MODE",
  Automobilista2: "MODE",
  AssettoCorsa: "MODE",
  LMU: { Hyper: "MOTOR MAP" },
  AssettoCorsaCompetizione: "ENGINE MAP",
  GT3: "MOTOR MAP",
  GTE: "ENGINE MIX",
};

/**
 * ---- 1.b ERS SOC SECTION ----
 * Describes current ERS state of charge in % units
 */
/** @type {StringRecord} */
const ERS_SOC_GAME_PROPERTY_MAP = {
  Generic: "ERSPercent",
  Automobilista2: "ERSPercent",
  AssettoCorsa: "GameRawData.Physics.KersCharge",
  LMU: "GameRawData.CurrentPlayerTelemetry.mBatteryChargeFraction",
};
/** @type {HigherOrderFunctionRecord} */
const ERS_SOC_TRANSFORMATION_MAP = {
  "GameRawData.Physics.KersCharge": () => (/** @type {number} */ charge) => charge * 100,
  "GameRawData.CurrentPlayerTelemetry.mBatteryChargeFraction": () => (/** @type {number} */ charge) => charge * 100,
};
/** @type {GameOrCarClassNullableStringRecord} */
const ERS_SOC_UI_PROPERTY_MAP = {
  Generic: "",
  Automobilista2: "SoC",
  AssettoCorsa: "SoC",
  Hyper: "SoC",
  LMP2: "",
  GT3: "",
  GTE: "",
};

/**
 * ---- 1.c ERS CURRENT SECTION ----
 * Describes current state of hybrid system, e.g. whether it is deploying/recharging
 */
/** @type {Object.<string | number, string>} */
const AMS2_ERS_CURRENT_LABEL_MAP = {
  1: { label: "Idle", color: "#FFFFFFFF" },
  2: { label: "Regen", color: "#FF40E0D0" },
  3: { label: "Deploy", color: "#FFFFD700" },
};
/** @type {LabelColorRecord} */
const AC1_ERS_CURRENT_LABEL_MAP = {
  1: { label: "Idle", color: "#FFFFFFFF" },
  2: { label: "unimplemented", color: "#FFFFD700" },
  3: { label: "unimplemented", color: "#FF40E0D0" },
  4: { label: "unimplemented", color: "#FFE82222" },
  5: { label: "unimplemented", color: "#FF4B0082" },
};
/** @type {LabelColorRecord} */
const LMU_ERS_CURRENT_LABEL_MAP = {
  1: { label: "Idle", color: "#FFFFFFFF" },
  2: { label: "Deploy", color: "#FFFFD700" },
  3: { label: "Regen", color: "#FF40E0D0" },
};
/** @type {GameOrCarClassLabelMapRecord} */
const ERS_CURRENT_LABEL_MAP = {
  // TODO: Implement generic label map
  Generic: new LabelMap({}),
  Automobilista2: new LabelMap(AMS2_ERS_CURRENT_LABEL_MAP),
  AssettoCorsa: new LabelMap(AC1_ERS_CURRENT_LABEL_MAP),
  LMU: new LabelMap(LMU_ERS_CURRENT_LABEL_MAP),
};
/** @type {StringRecord} */
const ERS_CURRENT_GAME_PROPERTY_MAP = {
  Generic: "unimplemented",
  Automobilista2: "GameRawData.mErsDeploymentMode",
  AssettoCorsa: "GameRawData.mErsDeploymentMode",
  LMU: "GameRawData.CurrentPlayerTelemetry.mElectricBoostMotorState",
};
/** @type {GameOrCarClassNullableStringRecord} */
const ERS_CURRENT_UI_PROPERTY_MAP = {
  Generic: "ERS",
  Automobilista2: "ERS",
  AssettoCorsa: "ERS",
  Hyper: "ERS",
  GTE: "",
  GT3: "",
};

/**
 * ---- 1.d ERS RECOVERY SECTION ----
 * Describes current ERS deployment mode
 */

/** @type {StringRecord} */
const ERS_RECOVERY_GAME_PROPERTY_MAP = {
  Generic: "unimplemented",
  LMU: "LMU_NeoRedPlugin.Extended.VM_REGEN_LEVEL",
};
/** @type {HigherOrderFunctionRecord} */
const ERS_RECOVERY_TRANSFORMATION_MAP = {
  "LMU_NeoRedPlugin.Extended.VM_REGEN_LEVEL": () => (/** @type {string} */ charge) => charge === "N/A" ? "-" : charge,
};
/** @type {GameOrCarClassNullableStringRecord} */
const ERS_RECOVERY_UI_PROPERTY_MAP = {
  Generic: "",
  Automobilista2: "Recovery",
  AssettoCorsa: "Recovery",
  Hyper: "Regen",
  LMP2: "",
  GTE: "",
  GT3: "",
};
/** @type {GameOrCarClassNullableStringRecord} */
const ERS_RECOVERY_POPUP_MAP = {
  Generic: "ERS RECOVERY",
  Automobilista2: "ERS RECOVERY",
  AssettoCorsa: "ERS RECOVERY",
  LMU: { Hyper: "REGEN LEVEL" },
};
/**
 * ---- 1.e ERS DELTA SECTION ----
 * Describes ERS delta to last lap
 */
/**
 * Use the SOC as the base for the ERS Delta calculation
 *  */
const ERS_DELTA_GAME_PROPERTY_MAP = ERS_SOC_GAME_PROPERTY_MAP;
/** @type {GameOrCarClassNullableStringRecord} */
const ERS_DELTA_UI_PROPERTY_MAP = {
  Generic: "",
  Automobilista2: "Δ",
  AssettoCorsa: "Δ",
  LMP1: "Δ",
  Hyper: "Δ",
  LMP2: "",
  GT3: "",
  GTE: "",
};
/**
 * Use the SOC as the base for the ERS LLap calculation
 *  */
const ERS_DELTA_TRANSFORMATION_MAP = ERS_SOC_TRANSFORMATION_MAP;
/**
 * ---- 1.f ERS LAP SECTION ----
 * Describes state of ERS at the moment of the last lap
 */
/**
 * Use the SOC as the base for the ERS LLap calculation
 *  */
const ERS_LAP_GAME_PROPERTY_MAP = ERS_SOC_GAME_PROPERTY_MAP;
/** @type {GameOrCarClassNullableStringRecord} */
const ERS_LAP_UI_PROPERTY_MAP = {
  Generic: "",
  Automobilista2: "LLap",
  AssettoCorsa: "LLap",
  Hyper: "LLap",
  LMP1: "LLap",
  LMP2: "",
  GTE: "",
  GT3: "",
};
/**
 * Use the SOC as the base for the ERS LLap calculation
 *  */
const ERS_LAP_TRANSFORMATION_MAP = ERS_SOC_TRANSFORMATION_MAP;

/**
 * ==== 2. CAR CONTROL SECTION ====
 * All hardcoded maps, labels and game properties related to car control functionality go here
 * ========================
 */
/** @type {StringRecord} */
const CAR_CONTROL_MASTER_SECTION_UI_LABELS = {
  Generic: "Control",
  GTE: "Elec",
  GT3: "Elec",
};
/**
 * ---- 2.a TRACTION CONTROL SECTION ----
 * Describes current TC level
 */
/** @type {StringRecord} */
const TC_GAME_PROPERTY_MAP = {
  Generic: "TCLevel",
  Automobilista2: "TCLevel",
  AssettoCorsa: "TCLevel",
  LMU: "LMU_NeoRedPlugin.Extended.VM_TRACTIONCONTROLMAP",
};
/** @type {GameOrCarClassNullableStringRecord} */
const TC_UI_PROPERTY_MAP = {
  Generic: "TC",
};
/** @type {GameOrCarClassNullableStringRecord} */
const TC_POPUP_MAP = {
  Generic: "TC LEVEL",
};
/** @type {HigherOrderFunctionRecord} */
const TC_TRANSFORMATION_MAP = {
  "LMU_NeoRedPlugin.Extended.VM_TRACTIONCONTROLMAP":
    () =>
    /**
     * @param {string} rawTcLevel
     */
    (rawTcLevel) => {
      if (rawTcLevel.includes("OFF")) {
        return "OFF";
      }

      const labelIndex = rawTcLevel.indexOf("(");
      const label = rawTcLevel[labelIndex + 1];
      const tcLevel = Number.parseInt(rawTcLevel);

      if (!tcLevel) {
        return "OFF";
      }

      return labelIndex > 0 ? `${tcLevel} (${label})` : tcLevel;
    },
};
/**
 * ---- 2.b TC SLIP SECTION ----
 * Describes current TC slip level
 */
/** @type {StringRecord} */
const TC_SLIP_GAME_PROPERTY_MAP = {
  LMU: "LMU_NeoRedPlugin.Extended.VM_TRACTIONCONTROLSLIPANGLEMAP",
};
/** @type {GameOrCarClassNullableStringRecord} */
const TC_SLIP_UI_PROPERTY_MAP = {
  Generic: "SLIP",
  AssettoCorsaCompetizione: "",
  iRacing: "TC1",
  LMU: {
    Generic: "SLIP",
    LMP2: "",
  },
};
/** @type {GameOrCarClassNullableStringRecord} */
const TC_SLIP_POPUP_MAP = {
  Generic: "TC SLIP LEVEL",
  iRacing: "TC1 LEVEL",
};
/**
 * ---- 2.c TC CUT SECTION ----
 * Describes current TC cut level
 */
/** @type {StringRecord} */
const TC_CUT_GAME_PROPERTY_MAP = {
  AssettoCorsaCompetizione: "GameRawData.Graphics.TCCut",
  LMU: "LMU_NeoRedPlugin.Extended.VM_TRACTIONCONTROLPOWERCUTMAP",
};
/** @type {GameOrCarClassNullableStringRecord} */
const TC_CUT_UI_PROPERTY_MAP = {
  Generic: "CUT",
  AssettoCorsaCompetizione: "Cut",
  iRacing: "TC2",
};
/** @type {GameOrCarClassNullableStringRecord} */
const TC_CUT_POPUP_MAP = {
  Generic: "TC CUT LEVEL",
  AssettoCorsaCompetizione: "TC CUT LEVEL",
  iRacing: "TC2 LEVEL",
};
/**
 * ---- 2.d ABS SECTION ----
 * Describes current ABS level
 */
/** @type {StringRecord} */
const ABS_GAME_PROPERTY_MAP = {
  Generic: "ABSLevel",
  LMU: "LMU_NeoRedPlugin.Extended.VM_ANTILOCKBRAKESYSTEMMAP",
};
/** @type {StringRecord} */
const LMU_ABS_LABEL_MAP = {
  0: "Off",
  1: "o 1 (LO)",
  2: "o 1 (MD)",
  3: "o 1 (HI)",
  4: "n 4 (LO)",
  5: "n 5 (MD)",
  6: "n 6 (HI)",
  7: "u 7 (LO)",
  8: "u 8 (MD)",
  9: "u 9 (HI)",
};
/** @type {GameOrCarClassLabelMapRecord} */
const ABS_LABEL_MAP = {
  LMU: new LabelMap(LMU_ABS_LABEL_MAP),
};
/** @type {HigherOrderFunctionRecord} */
const ABS_TRANSFORMATION_MAP = {
  "LMU_NeoRedPlugin.Extended.VM_ANTILOCKBRAKESYSTEMMAP":
    () =>
    /**
     * @param {string} rawAbsLevel
     */
    (rawAbsLevel) => {
      if (rawAbsLevel.includes("OFF")) {
        return 0;
      }

      const absLevel = Number.parseInt(rawAbsLevel);

      return absLevel;
    },
};
/** @type {GameOrCarClassNullableStringRecord} */
const ABS_UI_PROPERTY_MAP = {
  Generic: "ABS",
  Hyper: "",
  LMP1: "",
  LMP2: "",
  GTE: "",
};
/** @type {GameOrCarClassNullableStringRecord} */
const ABS_POPUP_MAP = {
  Generic: "ABS LEVEL",
};
/**
 * ---- 2.e BRAKE BIAS SECTION ----
 * Describes current brake bias
 */
/** @type {StringRecord} */
const BB_GAME_PROPERTY_MAP = {
  Generic: "BrakeBias",
};
/** @type {GameOrCarClassNullableStringRecord} */
const BB_UI_PROPERTY_MAP = {
  Generic: "BB",
};
/** @type {GameOrCarClassNullableStringRecord} */
const BB_POPUP_MAP = {
  Generic: "BRAKE BIAS",
};
/**
 * ---- 2.f BRAKE MIGRATION SECTION ----
 * Describes current brake migration setting
 */
/** @type {StringRecord} */
const BM_GAME_PROPERTY_MAP = {
  LMU: "LMU_NeoRedPlugin.Extended.VM_BRAKE_MIGRATION",
};
/** @type {GameOrCarClassNullableStringRecord} */
const BM_UI_PROPERTY_MAP = {
  Generic: "",
  LMU: { Hyper: "BM" },
};
/** @type {GameOrCarClassNullableStringRecord} */
const BM_POPUP_MAP = {
  Generic: "BRK MIGRATION",
};

/**
 * ==== 3. FUEL SECTION ====
 * All fuel information and calculations go here
 * ========================
 */
/** @type {StringRecord} */
const FUEL_MASTER_SECTION_UI_LABELS = {
  Generic: "Fuel",
  GTE: "Fuel",
  GT3: "Fuel",
  Hyper: "F/NRG",
};
/**
 * ---- 3.a FUEL STATE SECTION ----
 * Describes current Fuel state in liters
 */
/** @type {StringRecord} */
const FUEL_STATE_GAME_PROPERTY_MAP = {
  Generic: "Fuel",
};
/** @type {GameOrCarClassNullableStringRecord} */
const FUEL_STATE_UI_PROPERTY_MAP = {
  Generic: "Tank",
};
/**
 * ---- 3.b FUEL USAGE SECTION ----
 * Describes Fuel usage over the current lap
 */
/** @type {StringRecord} */
const FUEL_USAGE_GAME_PROPERTY_MAP = {
  Generic: "DataCorePlugin.Computed.Fuel_CurrentLapConsumption",
};
/** @type {GameOrCarClassNullableStringRecord} */
const FUEL_USAGE_UI_PROPERTY_MAP = {
  Generic: "TLap",
};
/**
 * ---- 3.c FUEL TIME SECTION ----
 * Projected remaining stint time at the current fuel usage rate
 */
/** @type {StringRecord} */
const FUEL_TIME_GAME_PROPERTY_MAP = {
  Generic: "DataCorePlugin.Computed.Fuel_RemainingTime",
};
/** @type {GameOrCarClassNullableStringRecord} */
const FUEL_TIME_UI_PROPERTY_MAP = {
  Generic: "ETime",
};
/**
 * ---- 3.d FUEL LAPS SECTION ----
 * Projected remaining laps number at the current fuel usage rate
 */
/** @type {StringRecord} */
const FUEL_LAPS_GAME_PROPERTY_MAP = {
  Generic: "DataCorePlugin.Computed.Fuel_RemainingLaps",
};
/** @type {GameOrCarClassNullableStringRecord} */
const FUEL_LAPS_UI_PROPERTY_MAP = {
  Generic: "ELaps",
};
/**
 * ---- 3.e FUEL DELTA SECTION ----
 * Describes fuel delta to last lap
 */
const FUEL_DELTA_GAME_PROPERTY_MAP = {
  ...FUEL_STATE_GAME_PROPERTY_MAP,
  LMU: {
    Hyper: "LMU_NeoRedPlugin.Energy.VE.Current_%",
  },
};
/** @type {GameOrCarClassNullableStringRecord} */
const FUEL_DELTA_UI_PROPERTY_MAP = {
  Generic: "Δ",
};
const FUEL_DELTA_TRANSFORMATION_MAP = {
  Fuel: () => (/** @type {number} */ fuel) => fuel.toFixed(2),
  "LMU_NeoRedPlugin.Energy.VE.Current_%": () => (/** @type {number} */ nrg) => nrg.toFixed(2),
};
/**
 * ---- 3.f NRG STATE SECTION ----
 * Current Virtual Energy allowance state
 */
/** @type {GameOrCarClassNullableStringRecord} */
const NRG_STATE_GAME_PROPERTY_MAP = {
  Generic: null,
  AssettoCorsa: "ERSPercent",
  LMU: {
    Hyper: "LMU_NeoRedPlugin.Energy.VE.Current_%",
    Generic: "Fuel",
  },
};
/** @type {GameOrCarClassNullableStringRecord} */
const NRG_STATE_UI_PROPERTY_MAP = {
  Generic: "",
  AssettoCorsa: "ERS Max",
  LMU: {
    Generic: "",
    Hyper: "NRG",
  },
};
const NRG_STATE_TRANSFORMATION_MAP = {
  ERSPercent: () => (/** @type {number} */ ers) => ers.toFixed(2),
  "LMU_NeoRedPlugin.Energy.VE.Current_%": () => (/** @type {number} */ nrg) => nrg.toFixed(2),
};
/**
 * ---- 3.f NRG USAGE SECTION ----
 * Current NRG usage per lap
 */
/** @type {GameOrCarClassNullableStringRecord} */
const NRG_USAGE_GAME_PROPERTY_MAP = {
  LMU: {
    Hyper: "LMU_NeoRedPlugin.Energy.VE.FractionPerLap_%",
  },
};
/** @type {GameOrCarClassNullableStringRecord} */
const NRG_USAGE_UI_PROPERTY_MAP = {
  Generic: "",
  LMU: {
    Generic: "",
    Hyper: "Laps",
  },
};
const NRG_USAGE_TRANSFORMATION_MAP = {
  "LMU_NeoRedPlugin.Energy.VE.FractionPerLap_%": () => (/** @type {number} */ nrg) => nrg.toFixed(2),
};
/**
 * ==== 3. TEMPERATURES SECTION ====
 * Essential temperature information goes here
 * ========================
 */
/** @type {StringRecord} */
const TEMP_MASTER_SECTION_UI_LABELS = {
  Generic: "Temp",
};
/**
 * ---- 4.a OIL TEMP SECTION ----
 * Oil temperature
 */
/** @type {StringRecord} */
const OIL_TEMP_GAME_PROPERTY_MAP = {
  Generic: "OilTemperature",
};

/** @type {GameOrCarClassNullableStringRecord} */
const OIL_TEMP_UI_PROPERTY_MAP = {
  Generic: "Oil",
};
/** @type {HigherOrderFunctionRecord} */
const OIL_TEMP_TRANSFORMATION_MAP = {
  WaterTemperature:
    () =>
    /**
     * @param {number} temp
     */
    (temp) =>
      Number.parseInt(temp.toFixed(0)),
};
/**
 * ---- 4.b WATER TEMP SECTION ----
 * Water temperature
 */
/** @type {StringRecord} */
const WATER_TEMP_GAME_PROPERTY_MAP = {
  Generic: "WaterTemperature",
};
/** @type {GameOrCarClassNullableStringRecord} */
const WATER_TEMP_UI_PROPERTY_MAP = {
  Generic: "Water",
};
/** @type {HigherOrderFunctionRecord} */
const WATER_TEMP_TRANSFORMATION_MAP = {
  WaterTemperature:
    () =>
    /**
     * @param {number} temp
     */
    (temp) =>
      Number.parseInt(temp.toFixed(0)),
};
/**
 * ---- 4.c ENGINE TEMP SECTION ----
 * Engine temperature
 */
/** @type {StringRecord} */
const ENGINE_TEMP_GAME_PROPERTY_MAP = {};
/** @type {GameOrCarClassNullableStringRecord} */
const ENGINE_TEMP_UI_PROPERTY_MAP = {};
/** @type {HigherOrderFunctionRecord} */
const ENGINE_TEMP_TRANSFORMATION_MAP = {};

/**
 * ==== 5. TYRES SECTION ====
 * All information regarding tyre temperatures and wear goes here
 * ========================
 */
/**
 * ---- 5.a FL TEMP SECTION ----
 */
/** @type {StringRecord} */
const FL_TYRE_TEMP_GAME_PROPERTY_MAP = {
  Generic: "TyreTemperatureFrontLeft",
};

/** @type {GameOrCarClassNullableStringRecord} */
const FL_TYRE_TEMP_UI_PROPERTY_MAP = {
  Generic: "°FL",
};
/** @type {HigherOrderFunctionRecord} */
const FL_TYRE_TEMP_TRANSFORMATION_MAP = {
  TyreTemperatureFrontLeft:
    () =>
    /**
     * @param {number} temp
     */
    (temp) =>
      Number.parseInt(temp.toFixed(0)),
};
/**
 * ---- 5.b FL WEAR SECTION ----
 */
/** @type {StringRecord} */
const FL_TYRE_WEAR_GAME_PROPERTY_MAP = {
  Generic: "TyreWearFrontLeft",
};

/** @type {GameOrCarClassNullableStringRecord} */
const FL_TYRE_WEAR_UI_PROPERTY_MAP = {
  Generic: "%FL",
};
/** @type {HigherOrderFunctionRecord} */
const FL_TYRE_WEAR_TRANSFORMATION_MAP = {
  TyreWearFrontLeft:
    (currentGame, carClass, carId) =>
    /**
     * @param {number} temp
     */
    (temp) =>
      getGameOrClassFunctionOverrides(
        currentGame,
        carClass,
        WEAR_TRANSFORMATION_PER_GAME_MAP,
        carId
      )(Number.parseInt(temp.toFixed(0))),
};
/**
 * ---- 5.b FL PRES SECTION ----
 */
/** @type {StringRecord} */
const FL_TYRE_PRES_GAME_PROPERTY_MAP = {
  Generic: "TyrePressureFrontLeft",
};

/** @type {GameOrCarClassNullableStringRecord} */
const FL_TYRE_PRES_UI_PROPERTY_MAP = {
  Generic: "%FL",
};
/** @type {HigherOrderFunctionRecord} */
const FL_TYRE_PRES_TRANSFORMATION_MAP = {
  TyrePressureFrontLeft:
    () =>
    /**
     * @param {number} temp
     */
    (temp) =>
      Number.parseFloat(temp.toFixed(1)),
};

/**
 * ---- 5.d FR TEMP SECTION ----
 */
/** @type {StringRecord} */
const FR_TYRE_TEMP_GAME_PROPERTY_MAP = {
  Generic: "TyreTemperatureFrontRight",
};

/** @type {GameOrCarClassNullableStringRecord} */
const FR_TYRE_TEMP_UI_PROPERTY_MAP = {
  Generic: "°FR",
};
/** @type {HigherOrderFunctionRecord} */
const FR_TYRE_TEMP_TRANSFORMATION_MAP = {
  TyreTemperatureFrontRight:
    () =>
    /**
     * @param {number} temp
     */
    (temp) =>
      Number.parseInt(temp.toFixed(0)),
};
/**
 * ---- 5.e FR WEAR SECTION ----
 */
/** @type {StringRecord} */
const FR_TYRE_WEAR_GAME_PROPERTY_MAP = {
  Generic: "TyreWearFrontRight",
};

/** @type {GameOrCarClassNullableStringRecord} */
const FR_TYRE_WEAR_UI_PROPERTY_MAP = {
  Generic: "%FR",
};
/** @type {HigherOrderFunctionRecord} */
const FR_TYRE_WEAR_TRANSFORMATION_MAP = {
  TyreWearFrontRight:
    (currentGame, carClass, carId) =>
    /**
     * @param {number} temp
     */
    (temp) =>
      getGameOrClassFunctionOverrides(
        currentGame,
        carClass,
        WEAR_TRANSFORMATION_PER_GAME_MAP,
        carId
      )(Number.parseInt(temp.toFixed(0))),
};
/**
 * ---- 5.f FR PRES SECTION ----
 */
/** @type {StringRecord} */
const FR_TYRE_PRES_GAME_PROPERTY_MAP = {
  Generic: "TyrePressureFrontRight",
};

/** @type {GameOrCarClassNullableStringRecord} */
const FR_TYRE_PRES_UI_PROPERTY_MAP = {
  Generic: "%FR",
};
/** @type {HigherOrderFunctionRecord} */
const FR_TYRE_PRES_TRANSFORMATION_MAP = {
  TyrePressureFrontRight:
    () =>
    /**
     * @param {number} temp
     */
    (temp) =>
      Number.parseFloat(temp.toFixed(1)),
};

/**
 * ---- 5.g RL TEMP SECTION ----
 */
/** @type {StringRecord} */
const RL_TYRE_TEMP_GAME_PROPERTY_MAP = {
  Generic: "TyreTemperatureRearLeft",
};

/** @type {GameOrCarClassNullableStringRecord} */
const RL_TYRE_TEMP_UI_PROPERTY_MAP = {
  Generic: "°RL",
};
/** @type {HigherOrderFunctionRecord} */
const RL_TYRE_TEMP_TRANSFORMATION_MAP = {
  TyreTemperatureRearLeft:
    () =>
    /**
     * @param {number} temp
     */
    (temp) =>
      Number.parseInt(temp.toFixed(0)),
};
/**
 * ---- 5.h RL WEAR SECTION ----
 */
/** @type {StringRecord} */
const RL_TYRE_WEAR_GAME_PROPERTY_MAP = {
  Generic: "TyreWearRearLeft",
};

/** @type {GameOrCarClassNullableStringRecord} */
const RL_TYRE_WEAR_UI_PROPERTY_MAP = {
  Generic: "%RL",
};
/** @type {HigherOrderFunctionRecord} */
const RL_TYRE_WEAR_TRANSFORMATION_MAP = {
  TyreWearRearLeft:
    (currentGame, carClass, carId) =>
    /**
     * @param {number} temp
     */
    (temp) =>
      getGameOrClassFunctionOverrides(
        currentGame,
        carClass,
        WEAR_TRANSFORMATION_PER_GAME_MAP,
        carId
      )(Number.parseInt(temp.toFixed(0))),
};
/**
 * ---- 5.i RL PRES SECTION ----
 */
/** @type {StringRecord} */
const RL_TYRE_PRES_GAME_PROPERTY_MAP = {
  Generic: "TyrePressureRearLeft",
};

/** @type {GameOrCarClassNullableStringRecord} */
const RL_TYRE_PRES_UI_PROPERTY_MAP = {
  Generic: "%RL",
};
/** @type {HigherOrderFunctionRecord} */
const RL_TYRE_PRES_TRANSFORMATION_MAP = {
  TyrePressureRearLeft:
    () =>
    /**
     * @param {number} temp
     */
    (temp) =>
      Number.parseFloat(temp.toFixed(1)),
};

/**
 * ---- 5.j RR TEMP SECTION ----
 */
/** @type {StringRecord} */
const RR_TYRE_TEMP_GAME_PROPERTY_MAP = {
  Generic: "TyreTemperatureRearRight",
};

/** @type {GameOrCarClassNullableStringRecord} */
const RR_TYRE_TEMP_UI_PROPERTY_MAP = {
  Generic: "°RR",
};
/** @type {HigherOrderFunctionRecord} */
const RR_TYRE_TEMP_TRANSFORMATION_MAP = {
  TyreTemperatureRearRight:
    () =>
    /**
     * @param {number} temp
     */
    (temp) =>
      Number.parseInt(temp.toFixed(0)),
};
/**
 * ---- 5.k RR WEAR SECTION ----
 */
/** @type {StringRecord} */
const RR_TYRE_WEAR_GAME_PROPERTY_MAP = {
  Generic: "TyreWearRearRight",
};

/** @type {GameOrCarClassNullableStringRecord} */
const RR_TYRE_WEAR_UI_PROPERTY_MAP = {
  Generic: "%RR",
};
/** @type {HigherOrderFunctionRecord} */
const RR_TYRE_WEAR_TRANSFORMATION_MAP = {
  TyreWearRearRight:
    (currentGame, carClass, carId) =>
    /**
     * @param {number} temp
     */
    (temp) =>
      getGameOrClassFunctionOverrides(
        currentGame,
        carClass,
        WEAR_TRANSFORMATION_PER_GAME_MAP,
        carId
      )(Number.parseInt(temp.toFixed(0))),
};
/**
 * ---- 5.l RR PRES SECTION ----
 */
/** @type {StringRecord} */
const RR_TYRE_PRES_GAME_PROPERTY_MAP = {
  Generic: "TyrePressureRearRight",
};

/** @type {GameOrCarClassNullableStringRecord} */
const RR_TYRE_PRES_UI_PROPERTY_MAP = {
  Generic: "%RR",
};
/** @type {HigherOrderFunctionRecord} */
const RR_TYRE_PRES_TRANSFORMATION_MAP = {
  TyrePressureRearRight:
    () =>
    /**
     * @param {number} pres
     */
    (pres) =>
      Number.parseFloat(pres.toFixed(1)),
};
/**
 * ---- 5.m WEAR TRANSFORMATION ----
 * Transformation for tyre wear depending on the game
 */
/** @type {GameOrCarClassNullableFunctionRecord} */
const WEAR_TRANSFORMATION_PER_GAME_MAP = {
  Generic: (wear) => 100 - wear,
  LMU: { Generic: (wear) => wear },
  AssettoCorsaCompetizione: { Generic: (wear) => 100 - wear },
};
/**
 * ---- 5.n IDEAL RANGES ----
 * Ideal ranges for tempreature, pressure, wear depending on game/car class
 * Consists of the following properties: { optimal, goodThreshold, criticalThreshold }
 * Optimal is considered ideal, and is the center around which the ranges are calculated
 * Everything in a `goodThreshold` around optimal is considered good
 * Everything in a `criticalThreshold` around optimal is considered bad, but not extreme
 * Everything outside of `badThreshold` is displayed as critical
 */
/** @type {GameOrCarClassNullableStringRecord} */
const PRIMARY_TYRE_METRIC_PER_GAME_MAP = {
  Generic: "Temp",
  AssettoCorsaCompetizione: "Pres",
};
/** @type {GameOrCarClassNullableStringRecord} */
const IDEAL_TYRE_TEMP_GAME_PROPERTY_MAP = {
  Generic: null,
  LMU: {
    Hard: "LMU_NeoRedPlugin.Tyre.OptimalCompoundTemp_Hard",
    Medium: "LMU_NeoRedPlugin.Tyre.OptimalCompoundTemp_Medium",
    Soft: "LMU_NeoRedPlugin.Tyre.OptimalCompoundTemp_Soft",
    Wet: "LMU_NeoRedPlugin.Tyre.OptimalCompoundTemp_Wet",
  },
};
/** @type {GameOrCarClassOptimalRangeRecord} */
const IDEAL_TYRE_TEMP_RANGES_MAP = {
  Generic: null,
  LMU: { Generic: { optimal: 90, goodThreshold: 10, criticalThreshold: 25 } },
};
/** @type {GameOrCarClassOptimalRangeRecord} */
const IDEAL_TYRE_WEAR_RANGES_MAP = {
  Generic: {
    optimal: 100,
    goodThreshold: 20,
    criticalThreshold: 40,
  },
};
/** @type {GameOrCarClassOptimalRangeRecord} */
const IDEAL_TYRE_PRES_RANGES_MAP = {
  Generic: null,
  AssettoCorsaCompetizione: { Generic: { optimal: 28, goodThreshold: 1, criticalThreshold: 3 } },
};
/**
 * ---- 5.o FL TYRE SECTION ----
 */
/** @type {GameOrCarClassNullableStringRecord} */
const FL_TYRE_TYPE_GAME_PROPERTY_MAP = {
  Generic: null,
  LMU: "LMU_NeoRedPlugin.Tyre.FL_TyreCompound_Name",
};
/**
 * ---- 5.p FR TYRE SECTION ----
 */
/** @type {GameOrCarClassNullableStringRecord} */
const FR_TYRE_TYPE_GAME_PROPERTY_MAP = {
  Generic: null,
  LMU: "LMU_NeoRedPlugin.Tyre.FR_TyreCompound_Name",
};
/**
 * ---- 5.q RL TYRE SECTION ----
 */
/** @type {GameOrCarClassNullableStringRecord} */
const RL_TYRE_TYPE_GAME_PROPERTY_MAP = {
  Generic: null,
  LMU: "LMU_NeoRedPlugin.Tyre.RL_TyreCompound_Name",
};
/**
 * ---- 5.r RR TYRE SECTION ----
 */
/** @type {GameOrCarClassNullableStringRecord} */
const RR_TYRE_TYPE_GAME_PROPERTY_MAP = {
  Generic: null,
  LMU: "LMU_NeoRedPlugin.Tyre.RR_TyreCompound_Name",
};

/**
 *  6. BRAKES
 *  - 6.a FL TEMP
 *  - 6.b FR TEMP
 *  - 6.c RL TEMP
 *  - 6.d RR TEMP
 */
/**
 * ---- 6.a FL TEMP SECTION ----
 */
/** @type {StringRecord} */
const FL_BRAKE_TEMP_GAME_PROPERTY_MAP = {
  Generic: "BrakeTemperatureFrontLeft",
};

/** @type {GameOrCarClassNullableStringRecord} */
const FL_BRAKE_TEMP_UI_PROPERTY_MAP = {
  Generic: "°FL",
};
/** @type {HigherOrderFunctionRecord} */
const FL_BRAKE_TEMP_TRANSFORMATION_MAP = {
  BrakeTemperatureFrontLeft:
    () =>
    /**
     * @param {number} temp
     */
    (temp) =>
      Number.parseInt(temp.toFixed(0)),
};
/**
 * ---- 6.b FR TEMP SECTION ----
 */
/** @type {StringRecord} */
const FR_BRAKE_TEMP_GAME_PROPERTY_MAP = {
  Generic: "BrakeTemperatureFrontRight",
};

/** @type {GameOrCarClassNullableStringRecord} */
const FR_BRAKE_TEMP_UI_PROPERTY_MAP = {
  Generic: "°FR",
};
/** @type {HigherOrderFunctionRecord} */
const FR_BRAKE_TEMP_TRANSFORMATION_MAP = {
  BrakeTemperatureFrontRight:
    () =>
    /**
     * @param {number} temp
     */
    (temp) =>
      Number.parseInt(temp.toFixed(0)),
};
/**
 * ---- 6.c FL TEMP SECTION ----
 */
/** @type {StringRecord} */
const RL_BRAKE_TEMP_GAME_PROPERTY_MAP = {
  Generic: "BrakeTemperatureRearLeft",
};

/** @type {GameOrCarClassNullableStringRecord} */
const RL_BRAKE_TEMP_UI_PROPERTY_MAP = {
  Generic: "°RL",
};
/** @type {HigherOrderFunctionRecord} */
const RL_BRAKE_TEMP_TRANSFORMATION_MAP = {
  BrakeTemperatureRearLeft:
    () =>
    /**
     * @param {number} temp
     */
    (temp) =>
      Number.parseInt(temp.toFixed(0)),
};
/**
 * ---- 6.d RR TEMP SECTION ----
 */
/** @type {StringRecord} */
const RR_BRAKE_TEMP_GAME_PROPERTY_MAP = {
  Generic: "BrakeTemperatureRearRight",
};

/** @type {GameOrCarClassNullableStringRecord} */
const RR_BRAKE_TEMP_UI_PROPERTY_MAP = {
  Generic: "°RR",
};
/** @type {HigherOrderFunctionRecord} */
const RR_BRAKE_TEMP_TRANSFORMATION_MAP = {
  BrakeTemperatureRearRight:
    () =>
    /**
     * @param {number} temp
     */
    (temp) =>
      Number.parseInt(temp.toFixed(0)),
};
/**
 * ---- 6.e IDEAL RANGES ----
 */
/** @type {GameOrCarClassOptimalRangeRecord} */
const IDEAL_BRAKE_TEMP_RANGES_MAP = {
  Generic: { optimal: 550, goodThreshold: 200, criticalThreshold: 300 },
  GT3: { optimal: 500, goodThreshold: 250, criticalThreshold: 250 },
  LMU: {
    GT3: { optimal: 500, goodThreshold: 250, criticalThreshold: 250 },
    Hyper: { optimal: 550, goodThreshold: 200, criticalThreshold: 300 },
  },
  AssettoCorsaCompetizione: { Generic: { optimal: 500, goodThreshold: 250, criticalThreshold: 250 } },
};
/**
 * ==== 10. OUTPUT SECTION ====
 * Master output function, this is the underlying function called by every other function on SimHub's side, which exposes everything in this file.
 * !!! YOU **MUST** ADD NEW VALUES TO THE OUTPUT OF `getTelemetryLabelsAndValues` IF YOU ADD NEW MAPPING SECTIONS !!!
 * ========================
 */
/**
 * @param {string} currentGame
 * @param {string | undefined} currentCarClass
 * @param {boolean} debugMode
 * @param {string | undefined} currentCarId
 * @param {string | undefined} currentTyre
 */
function getTelemetryLabelsAndValues(
  currentGame,
  currentCarClass,
  debugMode = false,
  currentCarId = undefined,
  currentTyre = undefined,
  currentLap = undefined,
  root = undefined
) {
  // 1
  const ersMasterSectionUiLabels = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ERS_MASTER_SECTION_UI_LABELS,
    currentCarId
  );
  // 1.a
  const ersModeGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ERS_MODE_GAME_PROPERTY_MAP,
    currentCarId
  );
  const ersModeLabelMap = getGameOrClassLabelMapOverrides(
    currentGame,
    currentCarClass,
    ERS_MODE_LABEL_MAP,
    currentCarId
  );
  const ersModeUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ERS_MODE_UI_PROPERTY_MAP,
    currentCarId
  );
  const ersModePopupMap = getGameOrClassStringOverrides(currentGame, currentCarClass, ERS_MODE_POPUP_MAP, currentCarId);
  // 1.b
  const ersSocGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ERS_SOC_GAME_PROPERTY_MAP,
    currentCarId
  );
  const ersSocUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ERS_SOC_UI_PROPERTY_MAP,
    currentCarId
  );
  // 1.c
  const ersCurrentGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ERS_CURRENT_GAME_PROPERTY_MAP,
    currentCarId
  );
  const ersCurrentLabel = getGameOrClassLabelMapOverrides(
    currentGame,
    currentCarClass,
    ERS_CURRENT_LABEL_MAP,
    currentCarId
  );
  const ersCurrentUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ERS_CURRENT_UI_PROPERTY_MAP,
    currentCarId
  );
  // 1.d
  const ersRecoveryGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ERS_RECOVERY_GAME_PROPERTY_MAP,
    currentCarId
  );
  const ersRecoveryUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ERS_RECOVERY_UI_PROPERTY_MAP,
    currentCarId
  );
  const ersRecoveryPopupMap = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ERS_RECOVERY_POPUP_MAP,
    currentCarId
  );
  // 1.e
  const ersDeltaGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ERS_DELTA_GAME_PROPERTY_MAP,
    currentCarId
  );
  const ersDeltaUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ERS_DELTA_UI_PROPERTY_MAP,
    currentCarId
  );
  // 1.f
  const ersLapGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ERS_LAP_GAME_PROPERTY_MAP,
    currentCarId
  );
  const ersLapUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ERS_LAP_UI_PROPERTY_MAP,
    currentCarId
  );

  // 2
  const carControlMasterSectionUILabels = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    CAR_CONTROL_MASTER_SECTION_UI_LABELS,
    currentCarId
  );
  // 2.a
  const tcGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    TC_GAME_PROPERTY_MAP,
    currentCarId
  );
  const tcUiProperty = getGameOrClassStringOverrides(currentGame, currentCarClass, TC_UI_PROPERTY_MAP, currentCarId);
  const tcPopup = getGameOrClassStringOverrides(currentGame, currentCarClass, TC_POPUP_MAP, currentCarId);
  // 2.b
  const tcSlipGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    TC_SLIP_GAME_PROPERTY_MAP,
    currentCarId
  );
  const tcSlipUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    TC_SLIP_UI_PROPERTY_MAP,
    currentCarId
  );
  const tcSlipPopup = getGameOrClassStringOverrides(currentGame, currentCarClass, TC_SLIP_POPUP_MAP, currentCarId);
  // 2.c
  const tcCutGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    TC_CUT_GAME_PROPERTY_MAP,
    currentCarId
  );
  const tcCutUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    TC_CUT_UI_PROPERTY_MAP,
    currentCarId
  );
  const tcCutPopup = getGameOrClassStringOverrides(currentGame, currentCarClass, TC_CUT_POPUP_MAP, currentCarId);
  // 2.d
  const absGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ABS_GAME_PROPERTY_MAP,
    currentCarId
  );
  const absUiProperty = getGameOrClassStringOverrides(currentGame, currentCarClass, ABS_UI_PROPERTY_MAP, currentCarId);
  const absPopup = getGameOrClassStringOverrides(currentGame, currentCarClass, ABS_POPUP_MAP, currentCarId);
  // 2.e
  const brakeBiasGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    BB_GAME_PROPERTY_MAP,
    currentCarId
  );
  const brakeBiasUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    BB_UI_PROPERTY_MAP,
    currentCarId
  );
  const brakeBiasPopup = getGameOrClassStringOverrides(currentGame, currentCarClass, BB_POPUP_MAP, currentCarId);
  // 2.f
  const brakeMigrationGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    BM_GAME_PROPERTY_MAP,
    currentCarId
  );
  const brakeMigrationUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    BM_UI_PROPERTY_MAP,
    currentCarId
  );
  const brakeMigrationPopup = getGameOrClassStringOverrides(currentGame, currentCarClass, BM_POPUP_MAP, currentCarId);

  // 3
  const fuelMasterSectionUILabels = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FUEL_MASTER_SECTION_UI_LABELS,
    currentCarId
  );
  // 3.a
  const fuelStateGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FUEL_STATE_GAME_PROPERTY_MAP,
    currentCarId
  );
  const fuelStateUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FUEL_STATE_UI_PROPERTY_MAP,
    currentCarId
  );
  // 3.b
  const fuelUsageGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FUEL_USAGE_GAME_PROPERTY_MAP,
    currentCarId
  );
  const fuelUsageUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FUEL_USAGE_UI_PROPERTY_MAP,
    currentCarId
  );
  // 3.c
  const fuelTimeGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FUEL_TIME_GAME_PROPERTY_MAP,
    currentCarId
  );
  const fuelTimeUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FUEL_TIME_UI_PROPERTY_MAP,
    currentCarId
  );
  // 3.d
  const fuelLapsGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FUEL_LAPS_GAME_PROPERTY_MAP,
    currentCarId
  );
  const fuelLapsUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FUEL_LAPS_UI_PROPERTY_MAP,
    currentCarId
  );
  // 3.e
  const fuelDeltaGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FUEL_DELTA_GAME_PROPERTY_MAP,
    currentCarId
  );
  const fuelDeltaUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FUEL_DELTA_UI_PROPERTY_MAP,
    currentCarId
  );
  // 3.f
  const nrgStateGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    NRG_STATE_GAME_PROPERTY_MAP,
    currentCarId
  );
  const nrgStateUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    NRG_STATE_UI_PROPERTY_MAP,
    currentCarId
  );
  // 3.g
  const nrgUsageGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    NRG_USAGE_GAME_PROPERTY_MAP,
    currentCarId
  );
  const nrgUsageUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    NRG_USAGE_UI_PROPERTY_MAP,
    currentCarId
  );

  // 4
  const tempMasterSectionUILabels = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    TEMP_MASTER_SECTION_UI_LABELS,
    currentCarId
  );
  // 4.a
  const oilTempGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    OIL_TEMP_GAME_PROPERTY_MAP,
    currentCarId
  );
  const oilTempUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    OIL_TEMP_UI_PROPERTY_MAP,
    currentCarId
  );
  // 4.b
  const waterTempGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    WATER_TEMP_GAME_PROPERTY_MAP,
    currentCarId
  );
  const waterTempUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    WATER_TEMP_UI_PROPERTY_MAP,
    currentCarId
  );
  // 4.c
  const engineTempGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ENGINE_TEMP_GAME_PROPERTY_MAP,
    currentCarId
  );
  const engineTempUiProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    ENGINE_TEMP_UI_PROPERTY_MAP,
    currentCarId
  );

  // 5.a
  const frontLeftTemperatureGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FL_TYRE_TEMP_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 5.b
  const frontLeftWearGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FL_TYRE_WEAR_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 5.c
  const frontLeftPressureGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FL_TYRE_PRES_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 5.d
  const frontRightTemperatureGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FR_TYRE_TEMP_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 5.e
  const frontRightWearGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FR_TYRE_WEAR_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 5.f
  const frontRightPressureGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FR_TYRE_PRES_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 5.g
  const rearLeftTemperatureGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    RL_TYRE_TEMP_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 5.h
  const rearLeftWearGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    RL_TYRE_WEAR_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 5.i
  const rearLeftPressureGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    RL_TYRE_PRES_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 5.j
  const rearRightTemperatureGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    RR_TYRE_TEMP_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 5.k
  const rearRightWearGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    RR_TYRE_WEAR_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 5.l
  const rearRightPressureGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    RR_TYRE_PRES_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 5.n
  const primaryTyreMetric = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    PRIMARY_TYRE_METRIC_PER_GAME_MAP,
    currentCarId,
    currentTyre
  );
  const optimalTyreTempProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    IDEAL_TYRE_TEMP_GAME_PROPERTY_MAP,
    currentCarId,
    currentTyre
  );
  const optimalTyreTempRanges = getGameOrClassNumberOverrides(
    currentGame,
    currentCarClass,
    IDEAL_TYRE_TEMP_RANGES_MAP,
    currentCarId,
    currentTyre
  );
  const optimalTyreWearRanges = getGameOrClassNumberOverrides(
    currentGame,
    currentCarClass,
    IDEAL_TYRE_WEAR_RANGES_MAP,
    currentCarId,
    currentTyre
  );
  const optimalTyrePresRanges = getGameOrClassNumberOverrides(
    currentGame,
    currentCarClass,
    IDEAL_TYRE_PRES_RANGES_MAP,
    currentCarId,
    currentTyre
  );
  // 5.o
  const frontLeftTyreTypeProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FL_TYRE_TYPE_GAME_PROPERTY_MAP,
    currentCarClass
  );
  // 5.p
  const frontRightTyreTypeProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FR_TYRE_TYPE_GAME_PROPERTY_MAP,
    currentCarClass
  );
  // 5.q
  const rearLeftTyreTypeProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    RL_TYRE_TYPE_GAME_PROPERTY_MAP,
    currentCarClass
  );
  // 5.r
  const rearRightTyreTypeProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    RR_TYRE_TYPE_GAME_PROPERTY_MAP,
    currentCarClass
  );

  // 6.a
  const frontLeftBrakeTemperatureGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FL_BRAKE_TEMP_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 6.b
  const frontRightBrakeTemperatureGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    FR_BRAKE_TEMP_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 6.c
  const rearLeftBrakeTemperatureGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    RL_BRAKE_TEMP_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 6.d
  const rearRightBrakeTemperatureGameProperty = getGameOrClassStringOverrides(
    currentGame,
    currentCarClass,
    RR_BRAKE_TEMP_GAME_PROPERTY_MAP,
    currentCarId
  );
  // 6.e
  const optimalBrakeTempRanges = getGameOrClassNumberOverrides(
    currentGame,
    currentCarClass,
    IDEAL_BRAKE_TEMP_RANGES_MAP,
    currentCarId,
    currentTyre
  );

  const resultMaps = {
    masterSectionUiLabels: {
      ers: ersMasterSectionUiLabels,
      carControl: carControlMasterSectionUILabels,
      fuel: fuelMasterSectionUILabels,
      temperature: tempMasterSectionUILabels,
    },
    labelMaps: {
      ers: {
        ersMode: ersModeLabelMap,
        ersSoc: null,
        ersCurrent: ersCurrentLabel,
        ersRecovery: null,
        ersDelta: null,
        ersLap: null,
      },
      carControl: {
        tc: null,
        tcCut: null,
        tcSlip: null,
        abs: null,
        brakeBias: null,
        brakeMigration: null,
      },
      fuel: {
        fuelState: null,
        fuelUsage: null,
        fuelTime: null,
        fuelLaps: null,
        fuelDelta: null,
        nrgState: null,
        nrgUsage: null,
      },
      temperature: {
        oil: null,
        water: null,
        engine: null,
      },
      tyre: {
        flTemp: null,
        frTemp: null,
        rlTemp: null,
        rrTemp: null,
        flWear: null,
        frWear: null,
        rlWear: null,
        rrWear: null,
        flPres: null,
        frPres: null,
        rlPres: null,
        rrPres: null,
      },
      brake: {
        flTemp: null,
        frTemp: null,
        rlTemp: null,
        rrTemp: null,
      },
    },
    gameProperties: {
      ers: {
        ersMode: ersModeGameProperty,
        ersSoc: ersSocGameProperty,
        ersCurrent: ersCurrentGameProperty,
        ersRecovery: ersRecoveryGameProperty,
        ersDelta: ersDeltaGameProperty,
        ersLap: ersLapGameProperty,
      },
      carControl: {
        tc: tcGameProperty,
        tcSlip: tcSlipGameProperty,
        tcCut: tcCutGameProperty,
        abs: absGameProperty,
        brakeBias: brakeBiasGameProperty,
        brakeMigration: brakeMigrationGameProperty,
      },
      fuel: {
        fuelState: fuelStateGameProperty,
        fuelUsage: fuelUsageGameProperty,
        fuelTime: fuelTimeGameProperty,
        fuelLaps: fuelLapsGameProperty,
        fuelDelta: fuelDeltaGameProperty,
        nrgState: nrgStateGameProperty,
        nrgUsage: nrgUsageGameProperty,
      },
      temperature: {
        oil: oilTempGameProperty,
        water: waterTempGameProperty,
      },
      tyre: {
        flTemp: frontLeftTemperatureGameProperty,
        frTemp: frontRightTemperatureGameProperty,
        rlTemp: rearLeftTemperatureGameProperty,
        rrTemp: rearRightTemperatureGameProperty,
        flWear: frontLeftWearGameProperty,
        frWear: frontRightWearGameProperty,
        rlWear: rearLeftWearGameProperty,
        rrWear: rearRightWearGameProperty,
        flPres: frontLeftPressureGameProperty,
        frPres: frontRightPressureGameProperty,
        rlPres: rearLeftPressureGameProperty,
        rrPres: rearRightPressureGameProperty,
        flType: frontLeftTyreTypeProperty,
        frType: frontLeftTyreTypeProperty,
        rlType: frontLeftTyreTypeProperty,
        rrType: frontLeftTyreTypeProperty,
      },
      brake: {
        flTemp: frontLeftBrakeTemperatureGameProperty,
        frTemp: frontRightBrakeTemperatureGameProperty,
        rlTemp: rearLeftBrakeTemperatureGameProperty,
        rrTemp: rearRightBrakeTemperatureGameProperty,
      },
    },
    transformations: {
      ers: {
        ersMode: ERS_MODE_TRANSFORMATION_MAP,
        ersSoc: ERS_SOC_TRANSFORMATION_MAP,
        ersCurrent: {},
        ersRecovery: ERS_RECOVERY_TRANSFORMATION_MAP,
        ersDelta: ERS_DELTA_TRANSFORMATION_MAP,
        ersLap: ERS_LAP_TRANSFORMATION_MAP,
      },
      carControl: {
        tc: TC_TRANSFORMATION_MAP,
        tcCut: {},
        tcSlip: {},
        abs: ABS_TRANSFORMATION_MAP,
        brakeBias: {},
        brakeMigration: {},
      },
      fuel: {
        fuelState: {},
        fuelUsage: {},
        fuelTime: {},
        fuelLaps: {},
        fuelDelta: FUEL_DELTA_TRANSFORMATION_MAP,
        nrgState: NRG_STATE_TRANSFORMATION_MAP,
        nrgUsage: NRG_USAGE_TRANSFORMATION_MAP,
      },
      temperature: {
        oil: OIL_TEMP_TRANSFORMATION_MAP,
        water: WATER_TEMP_TRANSFORMATION_MAP,
      },
      tyre: {
        flTemp: FL_TYRE_TEMP_TRANSFORMATION_MAP,
        frTemp: FR_TYRE_TEMP_TRANSFORMATION_MAP,
        rlTemp: RL_TYRE_TEMP_TRANSFORMATION_MAP,
        rrTemp: RR_TYRE_TEMP_TRANSFORMATION_MAP,
        flWear: FL_TYRE_WEAR_TRANSFORMATION_MAP,
        frWear: FR_TYRE_WEAR_TRANSFORMATION_MAP,
        rlWear: RL_TYRE_WEAR_TRANSFORMATION_MAP,
        rrWear: RR_TYRE_WEAR_TRANSFORMATION_MAP,
        flPres: FL_TYRE_PRES_TRANSFORMATION_MAP,
        frPres: FR_TYRE_PRES_TRANSFORMATION_MAP,
        rlPres: RL_TYRE_PRES_TRANSFORMATION_MAP,
        rrPres: RR_TYRE_PRES_TRANSFORMATION_MAP,
        wear: WEAR_TRANSFORMATION_PER_GAME_MAP,
      },
      brake: {
        flTemp: FL_BRAKE_TEMP_TRANSFORMATION_MAP,
        frTemp: FR_BRAKE_TEMP_TRANSFORMATION_MAP,
        rlTemp: RL_BRAKE_TEMP_TRANSFORMATION_MAP,
        rrTemp: RR_BRAKE_TEMP_TRANSFORMATION_MAP,
      },
    },
    uiLabels: {
      ers: {
        ersMode: ersModeUiProperty,
        ersSoc: ersSocUiProperty,
        ersCurrent: ersCurrentUiProperty,
        ersRecovery: ersRecoveryUiProperty,
        ersDelta: ersDeltaUiProperty,
        ersLap: ersLapUiProperty,
      },
      carControl: {
        tc: tcUiProperty,
        tcCut: tcCutUiProperty,
        tcSlip: tcSlipUiProperty,
        abs: absUiProperty,
        brakeBias: brakeBiasUiProperty,
        brakeMigration: brakeMigrationUiProperty,
      },
      fuel: {
        fuelState: fuelStateUiProperty,
        fuelUsage: fuelUsageUiProperty,
        fuelTime: fuelTimeUiProperty,
        fuelLaps: fuelLapsUiProperty,
        fuelDelta: fuelDeltaUiProperty,
        nrgState: nrgStateUiProperty,
        nrgUsage: nrgUsageUiProperty,
      },
      temperature: {
        oil: oilTempUiProperty,
        water: waterTempUiProperty,
        engine: engineTempUiProperty,
      },
      tyre: {
        flTemp: null,
        frTemp: null,
        rlTemp: null,
        rrTemp: null,
        flWear: null,
        frWear: null,
        rlWear: null,
        rrWear: null,
        flPres: null,
        frPres: null,
        rlPres: null,
        rrPres: null,
      },
      brake: {
        flTemp: null,
        frTemp: null,
        rlTemp: null,
        rrTemp: null,
      },
    },
    popupLabels: {
      ers: {
        ersMode: ersModePopupMap,
        ersSoc: null,
        ersCurrent: null,
        ersRecovery: ersRecoveryPopupMap,
        ersDelta: null,
        ersLap: null,
      },
      carControl: {
        tc: tcPopup,
        tcCut: tcCutPopup,
        tcSlip: tcSlipPopup,
        abs: absPopup,
        brakeBias: brakeBiasPopup,
        brakeMigration: brakeMigrationPopup,
      },
      fuel: {
        fuelState: null,
        fuelUsage: null,
        fuelTime: null,
        fuelLaps: null,
        fuelDelta: null,
        nrgState: null,
        nrgUsage: null,
      },
      temperature: {
        oil: null,
        water: null,
        engine: null,
      },
      tyre: {
        flTemp: null,
        frTemp: null,
        rlTemp: null,
        rrTemp: null,
        flWear: null,
        frWear: null,
        rlWear: null,
        rrWear: null,
        flPres: null,
        frPres: null,
        rlPres: null,
        rrPres: null,
      },
      brake: {
        flTemp: null,
        frTemp: null,
        rlTemp: null,
        rrTemp: null,
      },
    },
    optimalRanges: {
      tyre: {
        primaryTyreMetric,
        optimalTyreTempGameProperty: optimalTyreTempProperty,
        optimalTyrePresGameProperty: null,
        flTemp: optimalTyreTempRanges,
        frTemp: optimalTyreTempRanges,
        rlTemp: optimalTyreTempRanges,
        rrTemp: optimalTyreTempRanges,
        flWear: optimalTyreWearRanges,
        frWear: optimalTyreWearRanges,
        rlWear: optimalTyreWearRanges,
        rrWear: optimalTyreWearRanges,
        flPres: optimalTyrePresRanges,
        frPres: optimalTyrePresRanges,
        rlPres: optimalTyrePresRanges,
        rrPres: optimalTyrePresRanges,
      },
      brake: {
        flTemp: optimalBrakeTempRanges,
        frTemp: optimalBrakeTempRanges,
        rlTemp: optimalBrakeTempRanges,
        rrTemp: optimalBrakeTempRanges,
      },
    },
  };

  return {
    availableValues: debugMode
      ? JSON.stringify(resultMaps, null, 2)
      : "To see possible mappings, activate debug mode by passing `debugMode = true` to this function, as such: `getTelemetryLabelsAndValues(currentGame, currentCar, true)`",
    ...resultMaps,
  };
}

/**
 * ---- 10.b OUTPUT HELPERS SECTION ----
 * Functions that have more specific uses, to simplify calling form SimHub. For example: "getMasterSectionLabel" will just return the label of the master section instead of a bunch of unneeded details
 */
/**
 * @param {string} currentGame
 * @param {string | undefined} currentCarClass
 * @param {boolean} debugMode
 * @param {string} section
 * @param {boolean} debugMode
 * @param {string | undefined} currentCarId
 */
function getMasterSectionLabel(currentGame, currentCarClass, section, debugMode, currentCarId) {
  const telemetry = getTelemetryLabelsAndValues(currentGame, currentCarClass, debugMode, currentCarId);

  if (debugMode) {
    return telemetry.availableValues;
  }

  const label = telemetry.masterSectionUiLabels[section];

  if (label === undefined) {
    throw new Error(
      `${section} was not found in telemetry. Run in debug mode to double check return values: \`getPropertyValue(currentGame, carClass, section, property, debugMode = true)\``
    );
  }

  return label;
}
/**
 * @param {string} currentGame
 * @param {string | undefined} currentCarClass
 * @param {boolean} debugMode
 * @param {string} section
 * @param {string} property
 * @param {boolean} debugMode
 * @param {string | undefined} currentCarId
 */
function getPropertyPopupLabel(currentGame, currentCarClass, section, property, debugMode, currentCarId) {
  const telemetry = getTelemetryLabelsAndValues(currentGame, currentCarClass, debugMode, currentCarId);

  if (debugMode) {
    return telemetry.availableValues;
  }

  const label = telemetry.popupLabels[section][property];

  if (label === undefined) {
    throw new Error(
      `${section}:${property} was not found in telemetry. Run in debug mode to double check return values: \`getPropertyPopupLabel(currentGame, carClass, section, property, debugMode = true)\``
    );
  }

  return label;
}
/**
 * @param {string} currentGame
 * @param {string | undefined} currentCarClass
 * @param {boolean} debugMode
 * @param {string} section
 * @param {string} property
 * @param {boolean} debugMode
 * @param {string | undefined} currentCarId
 */
function getPropertyUILabel(currentGame, currentCarClass, section, property, debugMode, currentCarId) {
  const telemetry = getTelemetryLabelsAndValues(currentGame, currentCarClass, debugMode, currentCarId);

  if (debugMode) {
    return telemetry.availableValues;
  }

  const label = telemetry.uiLabels[section][property];

  if (label === undefined) {
    throw new Error(
      `${section}:${property} was not found in telemetry. Run in debug mode to double check return values: \`getPropertyUILabel(currentGame, carClass, section, property, debugMode = true)\``
    );
  }

  return label;
}
/**
 * @param {string} currentGame
 * @param {string | undefined} currentCarClass
 * @param {boolean} debugMode
 * @param {string} section
 * @param {string} property
 * @param {boolean} debugMode
 * @param {string | undefined} currentCarId
 */
function getPropertyValue(currentGame, currentCarClass, section, property, debugMode, currentCarId) {
  const telemetry = getTelemetryLabelsAndValues(currentGame, currentCarClass, debugMode, currentCarId);

  if (debugMode) {
    return telemetry.availableValues;
  }
  const propertyKey = telemetry.gameProperties[section][property];

  if (propertyKey === undefined) {
    throw new Error(
      `${section}:${property} was not found in telemetry. Run in debug mode to double check return values: \`getPropertyValue(currentGame, carClass, section, property, debugMode = true)\``
    );
  }

  const labelMap = telemetry.labelMaps[section][property];
  // Return identity function if transformation is undefined. Transformations are higher order functions that return a transform depending on the current game/class/car
  /** @type function(any): any */
  const transformation =
    section in telemetry.transformations &&
    telemetry.transformations[section] &&
    property in telemetry.transformations[section] &&
    telemetry.transformations[section][property] &&
    propertyKey in telemetry.transformations[section][property] &&
    telemetry.transformations[section][property][propertyKey]
      ? telemetry.transformations[section][property][propertyKey](currentGame, currentCarClass, currentCarId)
      : (prop) => prop;

  return { property: propertyKey, transformation, labelMap };
}

/**
 * @param {string} currentGame
 * @param {string | undefined} currentCarClass
 * @param {boolean} debugMode
 * @param {string} section
 * @param {string} property
 * @param {boolean} debugMode
 * @param {string | undefined} currentCarId
 */
function getPropertyOptimalRanges(currentGame, currentCarClass, section, property, debugMode, currentCarId) {
  const telemetry = getTelemetryLabelsAndValues(currentGame, currentCarClass, debugMode, currentCarId);

  if (debugMode) {
    return telemetry.availableValues;
  }

  const propertyKey = telemetry.gameProperties[section][property];

  if (propertyKey === undefined) {
    throw new Error(
      `${section}:${property} was not found in telemetry. Run in debug mode to double check return values: \`getPropertyOptimalRanges(currentGame, carClass, section, property, debugMode = true)\``
    );
  }
  const optimalRanges = telemetry.optimalRanges[section][property];

  // Return identity function if transformation is undefined. Transformations are higher order functions that return a transform depending on the current game/class/car
  /** @type function(any): any */
  const transformation =
    section in telemetry.transformations &&
    telemetry.transformations[section] &&
    property in telemetry.transformations[section] &&
    telemetry.transformations[section][property] &&
    propertyKey in telemetry.transformations[section][property] &&
    telemetry.transformations[section][property][propertyKey]
      ? telemetry.transformations[section][property][propertyKey](currentGame, currentCarClass, currentCarId)
      : (prop) => prop;

  return {
    property: propertyKey,
    transformation,
    optimalRanges: optimalRanges,
  };
}

/**
 * @param {string} currentGame
 * @param {string | undefined} currentCarClass
 * @param {string | undefined} currentTyre
 * @param {string | undefined} selectedTyre
 * @param {boolean} debugMode
 * @param {string | undefined} currentCarId
 */
function getPrimaryTyreMetric(currentGame, currentCarClass, selectedTyre, debugMode, currentCarId, currentTyre) {
  const telemetry = getTelemetryLabelsAndValues(currentGame, currentCarClass, debugMode, currentCarId, currentTyre);

  if (debugMode) {
    return telemetry.availableValues;
  }

  const tyreMetric = telemetry.optimalRanges.tyre.primaryTyreMetric;
  const tyreMetricGameProperty = telemetry.optimalRanges.tyre[`optimalTyre${tyreMetric}GameProperty`];
  const selectedTyreProperty = `${selectedTyre}${tyreMetric}`;

  return {
    tyreMetric,
    tyreMetricGameProperty,
    selectedProperty: selectedTyreProperty,
  };
}
