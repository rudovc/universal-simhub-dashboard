{"Variables":{"DashboardVariables":[{"VariableName":"targetOffset","EvaluateOnlyOnce":false,"OverrideWithParentDashboardVariableWhenAvailable":true,"ValueExpression":{"Expression":"0"},"EvaluateBeforeScreenRoles":false},{"VariableName":"strategy","EvaluateOnlyOnce":false,"OverrideWithParentDashboardVariableWhenAvailable":true,"ValueExpression":{"Expression":""},"EvaluateBeforeScreenRoles":false},{"VariableName":"estimatedLaps","EvaluateOnlyOnce":false,"OverrideWithParentDashboardVariableWhenAvailable":true,"ValueExpression":{"JSExt":1,"Interpreter":1,"Expression":"const currentGame = $prop('DataCorePlugin.CurrentGame');\r\nconst carClass = $prop('CarClass');\r\nconst carId = $prop('CarId');\r\nconst validLap = $prop('DataCorePlugin.Computed.Fuel_CurrentLapIsValidForTracking');\r\n\r\nconst { property, getFinalValue: getFinalLapsValue } = getPropertyValueFromConfig(config, currentGame, carClass, carId, 'fuel', 'laps');\r\nconst rawLaps = $prop(property);\r\nconst simhubRemaining = getFinalLapsValue(rawLaps);\r\n\r\nconst { property: stateProp, getFinalValue: getFinalState } = getPropertyValueFromConfig(config, currentGame, carClass, carId, \"fuel\", \"state\", root);\r\nconst rawStateValue = $prop(stateProp);\r\nconst fuelState = getFinalState(rawStateValue);\r\n\r\nconst { property: usageProp, getFinalValue: getFinalUsage } = getPropertyValueFromConfig(config, currentGame, carClass, carId, \"fuel\", \"lapUsage\", root);\r\nconst { property: avgUsageProp, getFinalValue: getAvgUsage } = getPropertyValueFromConfig(config, currentGame, carClass, carId, \"fuel\", \"avgUsage\", root);\r\nconst rawValue = $prop(usageProp);\r\nconst fuelUsage = getFinalUsage(rawValue);\r\nconst rawAvg = $prop(avgUsageProp);\r\nconst avgUsage = getAvgUsage(rawAvg);\r\n\r\nconst currentLap = $prop('CurrentLap');\r\n\r\nroot.prevLap = root.prevLap ?? currentLap;\r\nroot.pushUsage = root.pushUsage ?? null;\r\nroot.saveUsage = root.saveUsage ?? null;\r\nroot.usages = root.usages ?? {};\r\n\r\nconst lastLapUsages = cycleValuesOverNLaps(currentLap, fuelUsage, root.usages, 5, validLap);\r\nconst averageUsage = lastLapUsages.every(usage => !!usage) ? calculateArrayAverage(lastLapUsages) : avgUsage;\r\n\r\nconst isPit = $prop('IsInPit');\r\nconst remaining = fuelState && averageUsage ? fuelState / averageUsage : 0;\r\n\r\nroot.prevPushUsage = root.prevPushUsage && root.prevPushUsage > averageUsage ? root.prevPushUsage : averageUsage;\r\nroot.prevSaveUsage = root.prevSaveUsage && root.prevSaveUsage < averageUsage ? root.prevSaveUsage : averageUsage;\r\n\r\nif(!isPit && ((root.pushUsage == null || root.saveUsage == null) || currentLap % REFRESH_INTERVAL == 0)) {\r\n\troot.pushUsage = root.pushUsage ? (root.pushUsage > root.prevPushUsage ? root.pushUsage : averageUsage) : root.prevPushUsage;\r\n\troot.saveUsage = root.saveUsage ? (root.saveUsage < root.prevSaveUsage ? root.saveUsage : averageUsage) : averageUsage;\r\n\troot.avgUsage = root.prevSaveUsage;\r\n}\r\n\r\nreturn { remaining: simhubRemaining || remaining, loadedFuel: fuelState, pushUsage: root.pushUsage, saveUsage: root.saveUsage, avgUsage: averageUsage };","PreExpression":"const config = loadFromConfig();\r\nconst REFRESH_INTERVAL = 5;"},"EvaluateBeforeScreenRoles":false}]},"DashboardDebugManager":{},"Version":2,"Id":"f248c886-43bf-4b0d-8be0-49b21f60f3bb","BaseHeight":768,"BaseWidth":1280,"BackgroundColor":"#FF000000","Screens":[{"RenderingSkip":0,"Name":"Screen","InGameScreen":true,"IdleScreen":true,"PitScreen":false,"ScreenId":"de785561-f0dc-4982-8e6f-ffe1a0c6455e","AllowOverlays":true,"IsForegroundLayer":false,"IsOverlayLayer":false,"OverlayTriggerExpression":{"Expression":""},"ScreenEnabledExpression":{"Expression":""},"OverlayMaxDuration":0,"OverlayMinDuration":0,"IsBackgroundLayer":false,"BackgroundColor":"#FF000000","Items":[],"MinimumRefreshIntervalMS":0.0}],"SnapToGrid":false,"HideLabels":false,"ShowForeground":true,"ForegroundOpacity":100.0,"ShowBackground":true,"BackgroundOpacity":100.0,"ShowBoundingRectangles":false,"GridSize":10,"Images":[],"Metadata":{"ScreenCount":1.0,"InGameScreensIndexs":[0],"IdleScreensIndexs":[0],"MainPreviewIndex":0,"IsOverlay":false,"OverlaySizeWarning":true,"MetadataVersion":2.0,"EnableOnDashboardMessaging":true,"PitScreensIndexs":[],"SimHubVersion":"9.9.3","Width":1280.0,"Height":768.0,"DashboardVersion":""},"ShowOnScreenControls":true,"IsOverlay":false,"EnableClickThroughOverlay":true,"EnableOnDashboardMessaging":true,"UseStrictJSIsolation":false,"UseStrictJSIsolationWarning":true}